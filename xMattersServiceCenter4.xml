<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2026-01-05 18:01:10">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<application_name>Everbridge Flow Designer</application_name>
<application_scope>x_xma_eb_fd</application_scope>
<application_version>1.2.1</application_version>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>xMatters Service Center </name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>18a374cc83163210bdfce7d0deaad317</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:09</sys_created_on>
<sys_id>649c188983967210bdfce7d0deaad314</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:09</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_db_object_7f024736c3f1f21072461d0ed4013191</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_db_object"><sys_db_object action="INSERT_OR_UPDATE"><access>public</access><actions_access>false</actions_access><alter_access>false</alter_access><caller_access/><client_scripts_access>false</client_scripts_access><configuration_access>false</configuration_access><create_access>false</create_access><create_access_controls>true</create_access_controls><delete_access>false</delete_access><filter_extension/><is_df_table>false</is_df_table><is_extendable>false</is_extendable><label>xMatters Change Map</label><live_feed_enabled>false</live_feed_enabled><name>x_xma_eb_fd_xm_change_map</name><number_ref/><provider_class/><read_access>true</read_access><scriptable_table>false</scriptable_table><super_class/><sys_class_name>sys_db_object</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_id>7f024736c3f1f21072461d0ed4013191</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_db_object_7f024736c3f1f21072461d0ed4013191</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on><update_access>false</update_access><user_role display_value="x_xma_eb_fd.xmatters_change_map_user" name="x_xma_eb_fd.xmatters_change_map_user">c2624f36c3f1f21072461d0ed40131e1</user_role><ws_access>true</ws_access></sys_db_object></record_update>]]></payload>
<payload_hash>-156320422</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>209c188983967210bdfce7d0deaad319</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f740000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map</target_name>
<type>Table</type>
<update_domain>global</update_domain>
<update_guid>be62c3764af1f210591528f597d7b37f</update_guid>
<update_guid_history>be62c3764af1f210591528f597d7b37f:-156320422</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_xm_change_id_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="xm_change_id" label="xm change id" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element>xm_change_id</element><help/><hint/><label>xm change id</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>xm change ids</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:12:14</sys_created_on><sys_id>9354c7bac3f1f21072461d0ed4013192</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xm change id</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_xm_change_id_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:12:14</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>-598519501</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>209c188983967210bdfce7d0deaad3b2</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fa60000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.xm change id</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>1f540bbabef1f21057cfec350dc47af6</update_guid>
<update_guid_history>1f540bbabef1f21057cfec350dc47af6:-598519501</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_1662c376c3f1f21072461d0ed4013116</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl"><sys_security_acl action="INSERT_OR_UPDATE"><active>true</active><admin_overrides>true</admin_overrides><advanced>false</advanced><applies_to/><condition/><controlled_by_refs/><decision_type>allow</decision_type><description>Default access control on x_xma_eb_fd_xm_change_map</description><local_or_existing>Existing</local_or_existing><name>x_xma_eb_fd_xm_change_map</name><operation display_value="create">create</operation><script/><security_attribute/><sys_class_name>sys_security_acl</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_id>1662c376c3f1f21072461d0ed4013116</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_security_acl_1662c376c3f1f21072461d0ed4013116</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on><type display_value="record">record</type></sys_security_acl></record_update>]]></payload>
<payload_hash>-218294757</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>209c188983967210bdfce7d0deaad3b7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f370000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map</target_name>
<type>Access Control</type>
<update_domain>global</update_domain>
<update_guid>a262c37609f1f210f8043cbeda7f8927</update_guid>
<update_guid_history>a262c37609f1f210f8043cbeda7f8927:-218294757</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_properties_category_b5223fb483527210bdfce7d0deaad3d8</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_properties_category"&gt;&lt;sys_properties_category action="INSERT_OR_UPDATE"&gt;&lt;name&gt;Service and Change Intelligence Sync&lt;/name&gt;&lt;sys_class_name&gt;sys_properties_category&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2026-01-05 14:56:50&lt;/sys_created_on&gt;&lt;sys_id&gt;b5223fb483527210bdfce7d0deaad3d8&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Service and Change Intelligence Sync&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_properties_category_b5223fb483527210bdfce7d0deaad3d8&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2026-01-05 14:56:50&lt;/sys_updated_on&gt;&lt;title&gt;&lt;![CDATA[&lt;p style="text-align: center;"&gt;&lt;span style="font-size: 12pt;"&gt;&lt;strong&gt;Service and Change Intelligence Sync&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;]]&gt;&lt;/title&gt;&lt;/sys_properties_category&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=b5223fb483527210bdfce7d0deaad3d8"/&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1940221628</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>249c188983967210bdfce7d0deaad3b3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b8ea92d7b0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>Service and Change Intelligence Sync</target_name>
<type>System Property Category</type>
<update_domain>global</update_domain>
<update_guid>ec62bfb4bb527210a25af40033f3bd36</update_guid>
<update_guid_history>ec62bfb4bb527210a25af40033f3bd36:-1940221628</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_role_2262c376c3f1f21072461d0ed4013139</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl_role"><sys_security_acl_role action="INSERT_OR_UPDATE"><sys_class_name>sys_security_acl_role</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>2262c376c3f1f21072461d0ed4013139</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_security_acl display_value="x_xma_eb_fd_xm_change_map">e662c376c3f1f21072461d0ed4013135</sys_security_acl><sys_update_name>sys_security_acl_role_2262c376c3f1f21072461d0ed4013139</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><sys_user_role display_value="x_xma_eb_fd.xmatters_change_map_user" name="x_xma_eb_fd.xmatters_change_map_user">c2624f36c3f1f21072461d0ed40131e1</sys_user_role></sys_security_acl_role></record_update>]]></payload>
<payload_hash>-394338573</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>249c188983967210bdfce7d0deaad3b8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f560000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</target_name>
<type>Access Roles</type>
<update_domain>global</update_domain>
<update_guid>2a62c3765bf1f2105ed205ff5dbf813b</update_guid>
<update_guid_history>2a62c3765bf1f2105ed205ff5dbf813b:-394338573</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_register_c890c3bec3b1f21072461d0ed4013142</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><caller_access/><derived_priority>100</derived_priority><description/><event_name>x_xma_eb_fd.change.sync</event_name><fired_by/><priority>100</priority><queue/><suffix>change.sync</suffix><sys_class_name>sysevent_register</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 19:55:56</sys_created_on><sys_id>c890c3bec3b1f21072461d0ed4013142</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.change.sync</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sysevent_register_c890c3bec3b1f21072461d0ed4013142</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 19:55:56</sys_updated_on><table>change_request</table></sysevent_register></record_update>]]></payload>
<payload_hash>1375442736</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>289c188983967210bdfce7d0deaad316</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f1c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>change_request</table>
<target_name>x_xma_eb_fd.change.sync</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>f4a0c7be03b1f21014c8e640c05bf6ad</update_guid>
<update_guid_history>f4a0c7be03b1f21014c8e640c05bf6ad:1375442736</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_null</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label/&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element/&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="Collection"&gt;collection&lt;/internal_type&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;max_length&gt;40&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:03:43&lt;/sys_created_on&gt;&lt;sys_id&gt;2a62c376c3f1f21072461d0ed4013150&lt;/sys_id&gt;&lt;sys_name&gt;x_xma_eb_fd_xm_change_map&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_null&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:03:43&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>439105179</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>289c188983967210bdfce7d0deaad3af</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f670000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>7662c376e5f1f2101d03a24c22df817c</update_guid>
<update_guid_history>7662c376e5f1f2101d03a24c22df817c:439105179</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_scope_privilege_99db437ec335f21072461d0ed4013151</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_scope_privilege"><sys_scope_privilege action="INSERT_OR_UPDATE"><operation>execute</operation><source_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</source_scope><status>allowed</status><sys_class_name>sys_scope_privilege</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:44:52</sys_created_on><sys_id>99db437ec335f21072461d0ed4013151</sys_id><sys_mod_count>0</sys_mod_count><sys_name>GlideRecord.setWorkflow</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_scope_privilege_99db437ec335f21072461d0ed4013151</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:44:52</sys_updated_on><target_name>GlideRecord.setWorkflow</target_name><target_scope display_value="Global">global</target_scope><target_type>scriptable</target_type></sys_scope_privilege></record_update>]]></payload>
<payload_hash>-1572648045</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>289c188983967210bdfce7d0deaad3b4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fc30000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>GlideRecord.setWorkflow</target_name>
<type>Cross scope privilege</type>
<update_domain>global</update_domain>
<update_guid>1ddb437e8a35f210dfbb8fbe268c9153</update_guid>
<update_guid_history>1ddb437e8a35f210dfbb8fbe268c9153:-1572648045</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_ui_application_5e62c376c3f1f21072461d0ed401310e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_application"><sys_ui_application action="INSERT_OR_UPDATE"><active>true</active><hint/><name>xMatters Change Map</name><order/><roles>x_xma_eb_fd.xmatters_change_map_user</roles><sys_class_name>sys_ui_application</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>5e62c376c3f1f21072461d0ed401310e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Map</sys_name><sys_overrides/><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_ui_application_5e62c376c3f1f21072461d0ed401310e</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on></sys_ui_application></record_update>]]></payload>
<payload_hash>681461401</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>289c188983967210bdfce7d0deaad3b9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f2f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>xMatters Change Map</target_name>
<type>Application Menu</type>
<update_domain>global</update_domain>
<update_guid>9e62c376b7f1f210aa838cb57bb18310</update_guid>
<update_guid_history>9e62c376b7f1f210aa838cb57bb18310:681461401</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_script_action_a12a9ce2c339761072461d0ed401311a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;x_xma_eb_fd.service.delete&lt;/event_name&gt;&lt;name&gt;x_xma_eb_fd.service.delete&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[(function executeAction(current, event) {

    var targetName = (event.parm1 || '') + '';
    var ciSysId    = (event.parm2 || '') + '';

    gs.info('[serviceBatchSync] Delete Script Action fired. targetName="' + targetName + '" ciSysId=' + ciSysId);

    if (!targetName) {
        gs.error('[serviceBatchSync] Delete Script Action: missing parm1 (targetName)');
        return;
    }

    var sync = new x_xma_eb_fd.serviceBatchSync();
    sync.deleteServiceByTargetName(targetName);

})(current, event);
]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-16 13:12:35&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;a12a9ce2c339761072461d0ed401311a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;x_xma_eb_fd.service.delete&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_a12a9ce2c339761072461d0ed401311a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-16 13:12:35&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-983071552</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>2c9c188983967210bdfce7d0deaad317</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f040000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd.service.delete</table>
<target_name>x_xma_eb_fd.service.delete</target_name>
<type>Script Action</type>
<update_domain>global</update_domain>
<update_guid>1ebadce2ba397610b18bbdc2312482c2</update_guid>
<update_guid_history>1ebadce2ba397610b18bbdc2312482c2:-983071552</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_change_number_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="change_number" label="change number" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element>change_number</element><help/><hint/><label>change number</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>change numbers</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:11:37</sys_created_on><sys_id>9e3483bac3f1f21072461d0ed4013168</sys_id><sys_mod_count>0</sys_mod_count><sys_name>change number</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_change_number_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:11:37</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>371273215</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>2c9c188983967210bdfce7d0deaad3b0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f990000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.change number</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>663483bac7f1f210b3f242ced68c5fc8</update_guid>
<update_guid_history>663483bac7f1f210b3f242ced68c5fc8:371273215</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_include_256748dac35d321072461d0ed401318d</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;x_xma_eb_fd.xmApiClient&lt;/api_name&gt;&lt;caller_access/&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description&gt;//Copy of xm_api_client script include to extend access to the REST methods//&lt;/description&gt;&lt;mobile_callable&gt;false&lt;/mobile_callable&gt;&lt;name&gt;xmApiClient&lt;/name&gt;&lt;sandbox_callable&gt;false&lt;/sandbox_callable&gt;&lt;script&gt;&lt;![CDATA[gs.include('xm_logger');

const xmApiClient = Class.create();
xmApiClient.prototype = {
    initialize: function(initParams) {
        this.maxAttempts = 2;
        this.triggerProfile = initParams.triggerProfile;
        this.credentialsName = initParams.credentialsName;
        this.xmLogger = new xmLogger(initParams.traceId);
        this.missingCredentials = true;
        if (this.triggerProfile) {
            const triggerProfilesRec = new GlideRecordSecure(this.appScope + '_trigger_profiles');
            triggerProfilesRec.addQuery('name', this.triggerProfile);
            triggerProfilesRec.setLimit(1);
            triggerProfilesRec.query();
            if (triggerProfilesRec.next()) {
                this.triggerUrl = triggerProfilesRec.getValue('trigger_url');
                this.defaultSignalMode = triggerProfilesRec.getValue('default_signal_mode') || '';
                this.defaultAlertPriority = triggerProfilesRec.getValue('default_alert_priority') || '';
                this.defaultRecipients = triggerProfilesRec.getValue('additional_recipients_separate_recipients_with_commas') || '';
                this.credentialsName = triggerProfilesRec.credentials.name;
            } else {
                // Ideally we'd prefer throwing an error here, but it makes the logs unpalatable for our customers
                // Not throwing is acceptable, but we're setting a flag as to still avoid unnecessary requests
                this.xmLogger.error('Unable to find Trigger Profile "' + this.triggerProfile + '".');
            }
        }
        this.retrieveCredentials(this.credentialsName);
    },

    retrieveCredentials: function(credentialsName) {
        const credentialsRec = new GlideRecordSecure(this.appScope + '_credentials');
        credentialsRec.addQuery('name', credentialsName);
        credentialsRec.setLimit(1);
        credentialsRec.query();
        if (credentialsRec.next()) {
            this.username = credentialsRec.getValue('username');
            this.password = credentialsRec.getElement('password').getDecryptedValue();
            this.instanceUrl = credentialsRec.getValue('instance_url');
            this.clientId = credentialsRec.getValue('client_id');
            this.accessToken = credentialsRec.getElement('access_token').getDecryptedValue();
            this.refreshToken = credentialsRec.getElement('refresh_token').getDecryptedValue();
            this.credentials_sys_id = credentialsRec.getValue('sys_id');
            this.missingCredentials = false;
            if (this.clientId &amp;&amp; !this.refreshToken) {
                this.xmLogger.debug('First time initiating the client with this oauth profile.');
                return this.getOauthTokensByUsernamePassword();
            }
        } else {
            // not an error since triggerUrl could very well contain a valid apiKey
            this.xmLogger.debug('No authentication credentials associated with name "' + credentialsName + '".');
        }
    },

    sendRequest: function(req) {
        if (this.missingCredentials) {
            return;
        }
        const isOauth = !req.isFetchAccessTokenReq &amp;&amp; this.clientId &amp;&amp; this.username &amp;&amp; this.password;
        const restMessage = new sn_ws.RESTMessageV2();
        if (gs.getProperty(this.appScope + '.mid_server_enabled') === 'true') {
            restMessage.setMIDServer(gs.getProperty(this.appScope + '.mid_server_name'));
            restMessage.setEccParameter('skip_sensor', true);
        }
        if (isOauth) {
            this.xmLogger.debug('Sending OAuth request', {
                username: this.username
            });
            restMessage.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);
        } else {
            this.xmLogger.debug('Sending Basic auth request', {
                username: this.username
            });
            restMessage.setBasicAuth(this.username, this.password);
        }
        restMessage.setRequestHeader('Accept', 'application/json');
        restMessage.setRequestHeader('Content-Type', 'application/json');
        // override headers if some are provided
        if (this.isObjectLiteral(req.headers)) {
            Object.keys(req.headers).forEach(key =&gt; {
                restMessage.setRequestHeader(key, req.headers[key]);
            });
        }
        // but not the User-Agent
        restMessage.setRequestHeader('User-Agent', this.userAgent);
        restMessage.setHttpMethod(req.method.toLowerCase());
        restMessage.setEndpoint(req.url);
        const reqDetailsForLog = {
            'Trigger URL': restMessage.getEndpoint(),
            'Auth Type': isOauth ? 'OAuth' : 'Basic',
            'Headers': restMessage.getRequestHeaders(),
            'Credentials Profile Sys ID': this.credentials_sys_id
        };
        if (req.data) {
            const payload = req.data;
            restMessage.setRequestBody(typeof payload === 'string' ? payload : JSON.stringify(payload));
            reqDetailsForLog.Payload = req.isFetchAccessTokenReq ? 'Obfuscated sensitive data' : restMessage.getRequestBody();
        }
        this.xmLogger.debug('HTTP request details:', reqDetailsForLog);
        const response = restMessage.execute();
        const statusCode = response.getStatusCode();
        const responseBody = response.getBody();
        const payloadToLog = req.isFetchAccessTokenReq ? 'Obfuscated sensitive data' : responseBody;
        if (statusCode &gt;= 200 &amp;&amp; statusCode &lt; 300) {
            this.xmLogger.debug(`HTTP response details: received response with status code ${statusCode} and payload:`, payloadToLog);
        } else {
            this.xmLogger.error(`HTTP response details: received response with status code ${statusCode} and payload:`, payloadToLog);
        }
        return response;
    },

    requestor: function(req, attemptsCount = 1) {
        const originalResponse = this.sendRequest(req);
        const statusCode = originalResponse.getStatusCode();
        if (statusCode &lt; 200 || statusCode &gt;= 300) {
            if (attemptsCount &lt; this.maxAttempts) {
                this.xmLogger.debug('Request failed, will retry.', {
                    attemptNumber: attemptsCount
                });
                if (statusCode === 401) {
                    this.xmLogger.debug('Failure likely due to expired access token, attempting refresh.');
                    const oauthResponse = this.refreshAccessToken();
                    if (oauthResponse.getStatusCode() !== 200) {
                        return oauthResponse;
                    }
                }
                return this.requestor(req, attemptsCount + 1);
            }
        }
        return originalResponse;
    },

    get: function(url, headers) {
        return this.requestor({
            headers,
            method: 'get',
            url,
        });
    },

    post: function(url, data, headers) {
        return this.requestor({
            headers,
            method: 'post',
            url,
            data,
        });
    },

    delete: function(url, headers) {
        return this.requestor({
            headers,
            method: 'delete',
            url,
        });
    },

    handleTokensChange: function(oauthResponse) {
        const logForThis = (msg) =&gt; this.xmLogger.debug(msg, {
            credentialsName: this.credentialsName
        });
        if (oauthResponse.getStatusCode() === 200) {
            logForThis('Received new access token');
            const oAuthXmApiResponse = JSON.parse(oauthResponse.getBody());
            const {
                access_token,
                refresh_token
            } = oAuthXmApiResponse;
            this.accessToken = access_token;
            this.refreshToken = refresh_token;
            logForThis('Adding tokens to credentialsRecord');
            const credentialsRec = new GlideRecordSecure(this.appScope + '_credentials');
            credentialsRec.addQuery('name', this.credentialsName);
            credentialsRec.setLimit(1);
            credentialsRec.query();
            if (credentialsRec.next()) {
                credentialsRec.setValue('access_token', this.accessToken);
                credentialsRec.setValue('refresh_token', this.refreshToken);
                credentialsRec.update();
            } else {
                logForThis('credentialsRecord NOT found');
            }
            logForThis('Updating credentialsRecord was successful');
        }
        return oauthResponse;
    },

    getOauthTokens: function(oauthPayload) {
        const url = this.buildUrl('/oauth2/token');
        const headers = {
            'Content-Type': 'application/x-www-form-urlencoded'
        };
        const oauthResponse = this.sendRequest({
            method: 'post',
            url,
            data: oauthPayload,
            headers,
            isFetchAccessTokenReq: true,
        });
        return this.handleTokensChange(oauthResponse);
    },

    getOauthTokensByUsernamePassword: function() {
        this.xmLogger.debug('Getting oauth tokens by username &amp; password');
        const oauthPayload = 'grant_type=password&amp;client_id=' + this.clientId + '&amp;username=' + this.username + '&amp;password=' + this.password;
        return this.getOauthTokens(oauthPayload);
    },

    refreshAccessToken: function() {
        this.xmLogger.debug('Refreshing access token by refresh token', {
            clientId: this.clientId
        });
        const oauthPayload = 'grant_type=refresh_token&amp;client_id=' + this.clientId + '&amp;refresh_token=' + this.refreshToken;
        return this.getOauthTokens(oauthPayload);
    },

    isObjectLiteral: function(variable) {
        return typeof variable === 'object' &amp;&amp; variable !== null &amp;&amp; !Array.isArray(variable);
    },

    buildUrl: function(path, queryParams = {}) {
        const url = this.instanceUrl + this.xmApiRoot + path;
        const queryString = Object.entries(queryParams).map(([k, v]) =&gt; `${k}=${encodeURIComponent(v)}`).join('&amp;');
        const reqUrl = queryString ? (url + '?' + queryString) : url;
        return reqUrl;
    },

    type: 'xmApiClient',
    appScope: gs.getCurrentScopeName(),
    xmApiRoot: '/api/xm/1',
    userAgent: 'xm-ebfd-servicenow/1.0.0',

    // above this line: all fundamental elements of the client
    // below this line: all granular methods implemented for convenience of consumption

    sendSnowRecordAlert: function(metadata) {
        // Using a Set to avoid duplicates between and across supplied recipients and default recipients 
        const recipients = new Set();
        this.defaultRecipients
            .split(',')
            .forEach(recipient =&gt; {
                const targetName = recipient.trim();
                if (targetName) {
                    recipients.add(targetName);
                }
            });
        if (Array.isArray(metadata.recipients)) {
            metadata.recipients
                .forEach(recipient =&gt; {
                    const targetName = recipient.trim();
                    if (targetName) {
                        recipients.add(targetName);
                    }
                });
        }
        const data = {
            alertPriority: metadata.alertPriority || this.defaultAlertPriority,
            primaryRecord: metadata.primaryRecordProps,
            recipients: [...recipients].join(','),
            serviceNowBaseUrl: metadata.serviceNowBaseUrl,
            signalMode: metadata.signalMode || this.defaultSignalMode,
            snowEventTraceId: metadata.traceId,
        };
        if (metadata.secondaryRecordProps) {
            data.secondaryRecord = metadata.secondaryRecordProps;
        }
        return this.post(this.triggerUrl, data, metadata.headersOverride);
    },

    getInstanceUrl: function() {
        return this.instanceUrl;
    },

    fetchWorkflows: function(queryParams) {
        return this.get(this.buildUrl('/plans', queryParams));
    },

    fetchWorkflowById: function(workflowId, queryParams) {
        return this.get(this.buildUrl(`/plans/${workflowId}`, queryParams));
    },

    fetchRecipients: function(queryParams) {
        return this.get(this.buildUrl('/recipients', queryParams));
    },

    fetchXmattersBridges: function(queryParams) {
        return this.get(this.buildUrl('/conferences', queryParams));
    },

    fetchExternalBridges: function(queryParams) {
        return this.get(this.buildUrl('/conference-bridges', queryParams));
    },

    sendActionPayload: function(triggerUrl, payload) {
        return this.post(triggerUrl, payload);
    },
    // This would be another way of fetching triggers
    // (with query params like integrationType=INBOUND_WEBHOOK deployed=true etc)
    // but this approach would mean looping over all workflows and issue that many requests to xmApi
    // fetchWorkflowIntegrations: function(workflowId, queryParams) {
    //   return this.get(this.buildUrl(`/plans/${workflowId}/integrations`, queryParams));
    // }
};]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-11-20 20:38:50&lt;/sys_created_on&gt;&lt;sys_id&gt;256748dac35d321072461d0ed401318d&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name&gt;xmApiClient&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy&gt;read&lt;/sys_policy&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_256748dac35d321072461d0ed401318d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-04 17:10:11&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1149962809</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>2c9c188983967210bdfce7d0deaad3b5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2edd0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>xmApiClient</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>690ed72e72ad3610f6a8216d7cb444e1</update_guid>
<update_guid_history>690ed72e72ad3610f6a8216d7cb444e1:-1149962809,6aed994686657610113ddd3b659bbd21:-1584115466,7d87ccda725d32103b7de0864423372e:-2014544058</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_app_application_1a628376c3f1f21072461d0ed40131ba</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_application"><sys_app_application action="INSERT_OR_UPDATE"><active>true</active><category display_value="Custom Applications">e0355b31ef303000a61d5a3615c0fb78</category><description/><device_type>browser</device_type><hint/><name>xMatters Change Map</name><order>100</order><roles>x_xma_eb_fd.xmatters_change_map_user</roles><sys_class_name>sys_app_application</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>1a628376c3f1f21072461d0ed40131ba</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Map</sys_name><sys_overrides/><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_app_application_1a628376c3f1f21072461d0ed40131ba</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on><title>xMatters Change Map</title><view_name/></sys_app_application></record_update>]]></payload>
<payload_hash>-1188455353</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>609c188983967210bdfce7d0deaad318</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f260000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>xMatters Change Map</target_name>
<type>Application Menu</type>
<update_domain>global</update_domain>
<update_guid>de628376c7f1f210c3230fcf791a6fbd</update_guid>
<update_guid_history>de628376c7f1f210c3230fcf791a6fbd:-1188455353</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_change_sys_id_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="change_sys_id" label="change sys id" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element>change_sys_id</element><help/><hint/><label>change sys id</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>change sys ids</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:10:55</sys_created_on><sys_id>cc148b7ac3f1f21072461d0ed40131a7</sys_id><sys_mod_count>0</sys_mod_count><sys_name>change sys id</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_change_sys_id_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:10:55</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>1218409535</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>609c188983967210bdfce7d0deaad3b1</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f8e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.change sys id</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>5814cb7ad7f1f210d428728dba67e6e9</update_guid>
<update_guid_history>5814cb7ad7f1f210d428728dba67e6e9:1218409535</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_include_2d0f15c2c365761072461d0ed401318c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;x_xma_eb_fd.serviceBatchSync&lt;/api_name&gt;&lt;caller_access/&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description&gt;//Helper functions for handling xMatters Services synced from cmdb_ci_service table in SN. Looks up groups in xMatters and identifies Services where they are the designated support gfroup in ServiceNow//&lt;/description&gt;&lt;mobile_callable&gt;false&lt;/mobile_callable&gt;&lt;name&gt;serviceBatchSync&lt;/name&gt;&lt;sandbox_callable&gt;false&lt;/sandbox_callable&gt;&lt;script&gt;&lt;![CDATA[// Load the API client dependency used for authenticated xMatters REST calls
gs.include('xmApiClient');

var serviceBatchSync = Class.create();
serviceBatchSync.prototype = {
    initialize: function() {
        // Trace id to correlate logs for a single execution path
        this.traceId = gs.generateGUID();

        // xMatters API client (credentials record name pulled from property)
        this.client = new x_xma_eb_fd.xmApiClient({
            credentialsName: gs.getProperty('x_xma_eb_fd.service_and_change_sync_credential_name'),
            traceId: this.traceId
        });

        this.logPrefix             = '[serviceBatchSync]';
        this.serviceTable          = 'cmdb_ci_service';
        this.defaultOwnerGroupName = 'Unassigned Services';
        this.instanceBaseUrl       = gs.getProperty('glide.servlet.uri');
    },

    // ============================
    // PUBLIC ENTRYPOINTS
    // ============================

    // Scheduled job entrypoint: full CMDB  xMatters sync
    run: function() {
        gs.info(this.logPrefix + ' Starting full CMDB  xMatters service sync (traceId=' + this.traceId + ')');

        var xmGroups = this.getAllActiveGroupNamesSet();
        if (!xmGroups) {
            gs.error(this.logPrefix + ' Unable to retrieve xMatters groups; aborting batch sync.');
            return;
        }

        this.syncCmdbServicesToXm(xmGroups);
        gs.info(this.logPrefix + ' Completed full CMDB  xMatters service sync (traceId=' + this.traceId + ')');
    },

    // BR entrypoint: upsert a single service for a CI
    syncServiceForCi: function(ciGr) {
        if (!ciGr) {
            gs.error(this.logPrefix + ' syncServiceForCi: ciGr is null');
            return;
        }

        var xmGroups = this.getAllActiveGroupNamesSet();
        if (!xmGroups) {
            gs.error(this.logPrefix + ' syncServiceForCi: unable to load xMatters groups; aborting');
            return;
        }

        var payload = this.buildXmServicePayloadFromCmdb(ciGr, xmGroups);
        if (!payload) {
            gs.info(this.logPrefix + ' syncServiceForCi: CI ' + ciGr.getUniqueValue() + ' did not meet criteria / could not be mapped; skipping.');
            return;
        }

        this.createOrUpdateXmService(payload);
    },

    // BR entrypoint: rename-aware update (find by OLD name, update in place to NEW)
    syncServiceForCiUpdate: function(currentCi, previousCi) {
        if (!currentCi || !previousCi) {
            gs.error(this.logPrefix + ' syncServiceForCiUpdate: current or previous CI is null');
            return;
        }

        var xmGroups = this.getAllActiveGroupNamesSet();
        if (!xmGroups) {
            gs.error(this.logPrefix + ' syncServiceForCiUpdate: unable to load xMatters groups; aborting');
            return;
        }

        var oldTargetName = this.buildServiceTargetName(previousCi);
        var newTargetName = this.buildServiceTargetName(currentCi);

        var payload = this.buildXmServicePayloadFromCmdb(currentCi, xmGroups);
        if (!payload) {
            gs.info(this.logPrefix + ' syncServiceForCiUpdate: CI ' + currentCi.getUniqueValue() +
                ' did not meet criteria / could not be mapped; skipping.');
            return;
        }

        var existing = this.getServiceByTargetName(oldTargetName);
        if (existing &amp;&amp; existing.id) {
            payload.id = existing.id;
            gs.info(this.logPrefix + ' syncServiceForCiUpdate: Updating existing xMatters service after rename. ' +
                'Old name="' + oldTargetName + '", New name="' + newTargetName + '", id=' + existing.id);
            this.updateXmService(payload);
            return;
        }

        gs.info(this.logPrefix + ' syncServiceForCiUpdate: No existing xMatters service found for old name "' +
            oldTargetName + '". Falling back to normal sync for "' + newTargetName + '".');
        this.createOrUpdateXmService(payload);
    },

    // BR entrypoint: delete by computed targetName (CI name)
    deleteServiceForCi: function(ciGr) {
        if (!ciGr) {
            gs.error(this.logPrefix + ' deleteServiceForCi: ciGr is null');
            return;
        }

        var targetName = this.buildServiceTargetName(ciGr);
        if (!targetName) {
            gs.info(this.logPrefix + ' deleteServiceForCi: CI ' + ciGr.getUniqueValue() + ' has no name; nothing to delete in xMatters.');
            return;
        }

        var url  = this.client.buildUrl('/services/' + encodeURIComponent(targetName));
        var resp = this.client.delete(url);

        if (!resp) {
            gs.error(this.logPrefix + ' deleteServiceForCi: no response when deleting service "' + targetName + '"');
            return;
        }

        var status = resp.getStatusCode();
        var body   = resp.getBody();

        if (status == 200) {
            gs.info(this.logPrefix + ' Deleted xMatters service "' + targetName + '" for CI ' + ciGr.getUniqueValue());
        } else if (status == 204) {
            gs.info(this.logPrefix + ' xMatters service "' + targetName + '" not found when attempting delete (204). CI=' + ciGr.getUniqueValue());
        } else {
            gs.error(this.logPrefix + ' Failed to delete xMatters service "' + targetName + '". Status=' + status + ' Body=' + body);
        }
    },

    // ============================
    // BATCH HELPERS
    // ============================

    // Load ACTIVE xMatters groups into a set: { targetName: true }
    getAllActiveGroupNamesSet: function() {
        var names  = {};
        var limit  = 100;
        var offset = 0;
        var page   = 1;

        while (true) {
            var params = {
                status: 'ACTIVE',
                limit:  limit,
                offset: offset,
                sortBy: 'NAME',
                sortOrder: 'ASCENDING'
            };

            var url  = this.client.buildUrl('/groups', params);
            var resp = this.client.get(url);
            if (!resp) {
                gs.error(this.logPrefix + ' getAllActiveGroupNamesSet: no response from xMatters /groups');
                break;
            }

            var status = resp.getStatusCode();
            var body   = resp.getBody();

            if (status !== 200) {
                gs.error(this.logPrefix + ' getAllActiveGroupNamesSet: failed with status ' + status + ' body=' + body);
                break;
            }

            var parsed;
            try {
                parsed = JSON.parse(body);
            } catch (e) {
                gs.error(this.logPrefix + ' getAllActiveGroupNamesSet: error parsing JSON: ' + e.message + ' body=' + body);
                break;
            }

            var count = parsed.count || 0;
            var total = parsed.total || 0;
            var data  = parsed.data  || [];

            for (var i = 0; i &lt; data.length; i++) {
                var g = data[i];
                if (g &amp;&amp; g.targetName) {
                    names[g.targetName] = true;
                }
            }

            gs.info(this.logPrefix + ' Retrieved page ' + page + ' with ' + count + ' groups. Total so far: '
                + Object.keys(names).length + ' / ' + total);

            if (offset + count &gt;= total || count === 0) {
                break;
            }

            offset += count;
            page++;
        }

        return names;
    },

    // Iterate eligible CMDB services and upsert into xMatters
    syncCmdbServicesToXm: function(xmGroupsSet) {
        var gr = new GlideRecord(this.serviceTable);

        gr.addNotNullQuery('support_group');
        gr.addQuery('used_for', 'production');
        gr.addQuery('install_status', '1');
        gr.query();

        var processed = 0;
        while (gr.next()) {
            var payload = this.buildXmServicePayloadFromCmdb(gr, xmGroupsSet);
            if (!payload) {
                continue;
            }
            this.createOrUpdateXmService(payload);
            processed++;
        }

        gs.info(this.logPrefix + ' syncCmdbServicesToXm: processed ' + processed + ' services.');
    },

    // ============================
    // MAPPING HELPERS
    // ============================

    buildServiceTargetName: function(ciGr) {
        var name = ciGr.getValue('name');
        return name ? name : null;
    },

    buildXmServicePayloadFromCmdb: function(ciGr, xmGroupsSet) {
        var targetName = this.buildServiceTargetName(ciGr);
        if (!targetName) {
            return null;
        }

        var shortDesc = ciGr.getValue('short_description');
        var sysId     = ciGr.getUniqueValue();
        var desc      = shortDesc
            ? (shortDesc + ' (imported from SN CMDB: sys_id=' + sysId + ')')
            : (targetName + '  imported from SN CMDB (sys_id=' + sysId + ')');

        var ciUrl = this.buildServiceNowCiUrl(ciGr);
        if (ciUrl) {
            desc += '\nServiceNow CI: ' + ciUrl;
        }

        var serviceLinks = [];
        if (ciUrl) {
            serviceLinks.push({ label: targetName, url: ciUrl });
        }

        var crit = '';
        if (ciGr.isValidField('business_criticality')) {
            crit = ciGr.getValue('business_criticality');
        } else if (ciGr.isValidField('busines_criticality')) {
            crit = ciGr.getValue('busines_criticality');
        }
        var tier = this.mapBusinessCriticalityToServiceTier(crit);

        var classification = ciGr.isValidField('service_classification') ?
            ciGr.getValue('service_classification') : '';
        var serviceType = this.mapClassificationToServiceType(classification);

        var ownerGroupName = this.resolveOwnerGroupName(ciGr, xmGroupsSet);

        var payload = {
            targetName:  targetName,
            description: desc,
            serviceTier: tier,
            serviceType: serviceType
        };

        if (ownerGroupName) {
            payload.ownedBy = { targetName: ownerGroupName };
        }
        if (serviceLinks.length &gt; 0) {
            payload.serviceLinks = serviceLinks;
        }

        return payload;
    },

    buildServiceNowCiUrl: function(ciGr) {
        try {
            var base = this.instanceBaseUrl;
            var link = ciGr.getLink(); // relative: /cmdb_ci_service.do?sys_id=...
            if (link &amp;&amp; base) {
                return base + link;
            }
        } catch (e) {
            gs.error(this.logPrefix + ' buildServiceNowCiUrl: ' + e.message);
        }
        return '';
    },

    mapBusinessCriticalityToServiceTier: function(crit) {
        if (!crit) {
            return 'NONE';
        }

        crit = ('' + crit).toLowerCase();

        if (crit.indexOf('1') === 0 || crit.indexOf('most') &gt;= 0)       return 'PLATINUM';
        if (crit.indexOf('2') === 0 || crit.indexOf('somewhat') &gt;= 0)   return 'GOLD';
        if (crit.indexOf('3') === 0 || crit.indexOf('moderately') &gt;= 0) return 'SILVER';
        if (crit.indexOf('4') === 0 || crit.indexOf('not critical') &gt;= 0) return 'BRONZE';

        return 'NONE';
    },

    mapClassificationToServiceType: function(classification) {
        if (!classification) {
            return 'TECHNICAL';
        }

        classification = ('' + classification).toLowerCase();
        if (classification.indexOf('application') &gt;= 0 || classification.indexOf('business') &gt;= 0) {
            return 'APPLICATION';
        }

        return 'TECHNICAL';
    },

    resolveOwnerGroupName: function(ciGr, xmGroupsSet) {
        var groupSysId = '';

        if (ciGr.isValidField('support_group') &amp;&amp; !ciGr.support_group.nil()) {
            groupSysId = ciGr.getValue('support_group');
        } else if (ciGr.isValidField('assignment_group') &amp;&amp; !ciGr.assignment_group.nil()) {
            groupSysId = ciGr.getValue('assignment_group');
        } else if (ciGr.isValidField('managed_by_group') &amp;&amp; !ciGr.managed_by_group.nil()) {
            groupSysId = ciGr.getValue('managed_by_group');
        }

        var groupName = '';
        if (groupSysId) {
            var grp = new GlideRecord('sys_user_group');
            if (grp.get(groupSysId)) {
                groupName = grp.getValue('name');
            }
        }

        if (!groupName) {
            groupName = this.defaultOwnerGroupName;
        }

        if (xmGroupsSet &amp;&amp; !xmGroupsSet[groupName]) {
            gs.info(this.logPrefix + ' resolveOwnerGroupName: SN group "' + groupName + '" not found in xMatters; ' +
                'falling back to default owner "' + this.defaultOwnerGroupName + '".');

            if (xmGroupsSet[this.defaultOwnerGroupName]) {
                return this.defaultOwnerGroupName;
            }

            return '';
        }

        return groupName;
    },

    // ============================
    // xMATTERS HELPERS
    // ============================

    getServiceByTargetName: function(targetName) {
        if (!targetName) {
            return null;
        }

        var params = {
            search: '"' + targetName + '"',
            fields: 'NAME',
            limit:  50
        };

        var url  = this.client.buildUrl('/services', params);
        var resp = this.client.get(url);

        if (!resp) {
            gs.error(this.logPrefix + ' getServiceByTargetName: no response from xMatters for "' + targetName + '"');
            return null;
        }

        var status = resp.getStatusCode();
        var body   = resp.getBody();

        if (status !== 200) {
            gs.error(this.logPrefix + ' getServiceByTargetName: status ' + status + ' body=' + body);
            return null;
        }

        var parsed;
        try {
            parsed = JSON.parse(body);
        } catch (e) {
            gs.error(this.logPrefix + ' getServiceByTargetName: error parsing JSON: ' + e.message + ' body=' + body);
            return null;
        }

        var data = parsed.data || [];
        for (var i = 0; i &lt; data.length; i++) {
            if (data[i].targetName === targetName) {
                return data[i];
            }
        }

        return null;
    },

    // Update by id (required for rename-safe updates)
    updateXmService: function(payload) {
        if (!payload || !payload.targetName) {
            gs.error(this.logPrefix + ' updateXmService: invalid payload (no targetName)');
            return;
        }

        if (!payload.id) {
            gs.info(this.logPrefix + ' updateXmService: no id on payload for "' + payload.targetName +
                '", delegating to createOrUpdateXmService.');
            return this.createOrUpdateXmService(payload);
        }

        var url = this.client.buildUrl('/services');

        var updateBody = {
            id:          payload.id,
            targetName:  payload.targetName,
            description: payload.description,
            serviceTier: payload.serviceTier,
            serviceType: payload.serviceType
        };

        if (payload.ownedBy) {
            updateBody.ownedBy = payload.ownedBy;
        }
        if (payload.serviceLinks) {
            updateBody.serviceLinks = payload.serviceLinks;
        }

        var resp = this.client.post(url, updateBody);
        if (!resp) {
            gs.error(this.logPrefix + ' updateXmService: no response updating "' + payload.targetName + '"');
            return;
        }

        var status = resp.getStatusCode();
        if (status &gt;= 200 &amp;&amp; status &lt; 300) {
            gs.info(this.logPrefix + ' Updated xMatters service "' + payload.targetName +
                '" (id=' + payload.id + '). Status=' + status);
        } else {
            gs.error(this.logPrefix + ' Failed to update xMatters service "' + payload.targetName +
                '" (id=' + payload.id + '). Status=' + status + ' Body=' + resp.getBody());
        }

        return resp;
    },

    // Rename-aware update when you already know the old targetName string
    syncServiceForCiUpdateByOldName: function(currentCi, oldTargetName) {
        if (!currentCi || !oldTargetName) {
            gs.error(this.logPrefix + ' syncServiceForCiUpdateByOldName: missing currentCi or oldTargetName');
            return;
        }

        var xmGroups = this.getAllActiveGroupNamesSet();
        if (!xmGroups) {
            gs.error(this.logPrefix + ' syncServiceForCiUpdateByOldName: unable to load xMatters groups; aborting');
            return;
        }

        var payload = this.buildXmServicePayloadFromCmdb(currentCi, xmGroups);
        if (!payload) {
            gs.info(this.logPrefix + ' syncServiceForCiUpdateByOldName: CI ' + currentCi.getUniqueValue() +
                ' did not meet criteria / could not be mapped; skipping.');
            return;
        }

        var existing = this.getServiceByTargetName(oldTargetName);
        if (existing &amp;&amp; existing.id) {
            payload.id = existing.id;
            gs.info(this.logPrefix + ' syncServiceForCiUpdateByOldName: Updating after rename. Old="' +
                oldTargetName + '" New="' + payload.targetName + '" id=' + existing.id);
            this.updateXmService(payload);
            return;
        }

        gs.info(this.logPrefix + ' syncServiceForCiUpdateByOldName: No existing service found for old name "' +
            oldTargetName + '". Falling back to normal upsert for "' + payload.targetName + '".');
        this.createOrUpdateXmService(payload);
    },

    // Delete by targetName, fallback to delete-by-id if needed
    deleteServiceByTargetName: function(targetName) {
        targetName = (targetName || '') + '';
        if (!targetName) {
            gs.error(this.logPrefix + ' deleteServiceByTargetName: targetName is empty');
            return;
        }

        var url  = this.client.buildUrl('/services/' + encodeURIComponent(targetName));
        var resp = this.client.delete(url);

        if (!resp) {
            gs.error(this.logPrefix + ' deleteServiceByTargetName: no response deleting "' + targetName + '"');
            return;
        }

        var status = resp.getStatusCode();
        var body   = resp.getBody();

        if (status &gt;= 200 &amp;&amp; status &lt; 300) {
            gs.info(this.logPrefix + ' Deleted xMatters service "' + targetName + '". Status=' + status);
            return resp;
        }

        var existing = this.getServiceByTargetName(targetName);
        if (existing &amp;&amp; existing.id) {
            var urlById  = this.client.buildUrl('/services/' + encodeURIComponent(existing.id));
            var respById = this.client.delete(urlById);

            if (respById) {
                var st2 = respById.getStatusCode();
                if (st2 &gt;= 200 &amp;&amp; st2 &lt; 300) {
                    gs.info(this.logPrefix + ' Deleted xMatters service by id. targetName="' + targetName + '" id=' + existing.id + ' Status=' + st2);
                } else {
                    gs.error(this.logPrefix + ' Delete-by-id failed. targetName="' + targetName + '" id=' + existing.id +
                        ' Status=' + st2 + ' Body=' + respById.getBody());
                }
            }
            return respById;
        }

        gs.error(this.logPrefix + ' Delete failed for "' + targetName + '". Status=' + status + ' Body=' + body);
        return resp;
    },

    // Upsert by targetName (create if missing; update if found)
    createOrUpdateXmService: function(payload) {
        if (!payload || !payload.targetName) {
            gs.error(this.logPrefix + ' createOrUpdateXmService: invalid payload (no targetName)');
            return;
        }

        var existing = this.getServiceByTargetName(payload.targetName);
        var url      = this.client.buildUrl('/services');
        var resp, status;

        if (existing &amp;&amp; existing.id) {
            var updateBody = {
                id:          existing.id,
                targetName:  payload.targetName,
                description: payload.description,
                serviceTier: payload.serviceTier,
                serviceType: payload.serviceType
            };

            if (payload.ownedBy) {
                updateBody.ownedBy = payload.ownedBy;
            }
            if (payload.serviceLinks) {
                updateBody.serviceLinks = payload.serviceLinks;
            }

            resp = this.client.post(url, updateBody);
            if (!resp) {
                gs.error(this.logPrefix + ' createOrUpdateXmService: no response updating "' + payload.targetName + '"');
                return;
            }

            status = resp.getStatusCode();
            if (status === 200) {
                gs.info(this.logPrefix + ' Updated xMatters service "' + payload.targetName + '"');
            } else {
                gs.error(this.logPrefix + ' Failed to update xMatters service "' + payload.targetName
                    + '". Status=' + status + ' Body=' + resp.getBody());
            }
        } else {
            resp = this.client.post(url, payload);
            if (!resp) {
                gs.error(this.logPrefix + ' createOrUpdateXmService: no response creating "' + payload.targetName + '"');
                return;
            }

            status = resp.getStatusCode();
            if (status === 201 || status === 200) {
                gs.info(this.logPrefix + ' Created xMatters service "' + payload.targetName + '"');
            } else {
                gs.error(this.logPrefix + ' Failed to create xMatters service "' + payload.targetName
                    + '". Status=' + status + ' Body=' + resp.getBody());
            }
        }
    },

    type: 'serviceBatchSync'
};


]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-02 18:50:02&lt;/sys_created_on&gt;&lt;sys_id&gt;2d0f15c2c365761072461d0ed401318c&lt;/sys_id&gt;&lt;sys_mod_count&gt;20&lt;/sys_mod_count&gt;&lt;sys_name&gt;serviceBatchSync&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy&gt;read&lt;/sys_policy&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_2d0f15c2c365761072461d0ed401318c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2026-01-05 14:47:52&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<payload_hash>694752088</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>609c188983967210bdfce7d0deaad3b6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b8ea0f8ab0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>serviceBatchSync</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>8950b7f8fb12721064c4a482bcd9e091</update_guid>
<update_guid_history>8950b7f8fb12721064c4a482bcd9e091:694752088,d539abb886de3210a121529cdcfc98ea:354446287,97fcb0239971f2104520f7f7b221e51d:-664510159,2ec8fc670131f21092b4fb62d167d2dd:1792186248,ed5ad2323c7db21066671dc7b997e18b:1322832384,1ffccafea7b9b210783dc01f8f8b8836:229356654,21ea297ea675b2100dee811a6d709649:10762826,2834682e27797610c9c058dff139bebb:10389604,8c1b9c6618397610638990918c3820ba:-2057870542,a5beb1dad0313610d75b4cb9177b19f4:133810814,4d3bf192fe3136108053acda4ab5b0b9:-16194441,c7fe4e6488b5b2102a7d95bb1f77ca6d:-110842936,350cd58f742d72100af1ff40a6f7fab9:-1020868248,dccb408fa7217210222d1d3fbae00375:1085691538,131e49ba77ed76109ba8239f7f36f28d:-819134786,c41e9b2ee8ad3610400a64ef7bf5fa71:-2024471520,57001b6a0a2d36100c10d82c5eafd226:1277152209,9431321aef61b210294b4cf9d9c578bf:-322854075,54c4ee5a86ed7210b3af8890fbd162cc:-933112352,f30ece92892d72102d32733cc8029467:-162957302,11b1698eba6576109187e35da882341c:-1712941978</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_change_number</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="change_number" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;change number&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;change_number&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="String"&gt;string&lt;/internal_type&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;max_length&gt;100&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:11:37&lt;/sys_created_on&gt;&lt;sys_id&gt;eb144f7ac3f1f21072461d0ed40131f9&lt;/sys_id&gt;&lt;sys_name&gt;change number&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_change_number&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:11:37&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>104067213</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>649c188983967210bdfce7d0deaad319</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f940000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.change number</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>263483bac4f1f2107f5afe85d9ce496f</update_guid>
<update_guid_history>263483bac4f1f2107f5afe85d9ce496f:104067213</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_xm_service_target_name_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="xm_service_target_name" label="xm service target name" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element>xm_service_target_name</element><help/><hint/><label>xm service target name</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>xm service target names</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:12:53</sys_created_on><sys_id>bc844fbac3f1f21072461d0ed401315b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xm service target name</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_xm_service_target_name_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:12:53</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>1154214155</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>649c188983967210bdfce7d0deaad3b2</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fb10000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.xm service target name</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>3c8483fa7ef1f210588c2224995bb896</update_guid>
<update_guid_history>3c8483fa7ef1f210588c2224995bb896:1154214155</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_2e62c376c3f1f21072461d0ed401313c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl"><sys_security_acl action="INSERT_OR_UPDATE"><active>true</active><admin_overrides>true</admin_overrides><advanced>false</advanced><applies_to/><condition/><controlled_by_refs/><decision_type>allow</decision_type><description>Default access control on x_xma_eb_fd_xm_change_map</description><local_or_existing>Existing</local_or_existing><name>x_xma_eb_fd_xm_change_map</name><operation display_value="delete">delete</operation><script/><security_attribute/><sys_class_name>sys_security_acl</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>2e62c376c3f1f21072461d0ed401313c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_security_acl_2e62c376c3f1f21072461d0ed401313c</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><type display_value="record">record</type></sys_security_acl></record_update>]]></payload>
<payload_hash>-1907255555</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>649c188983967210bdfce7d0deaad3b7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f5d0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map</target_name>
<type>Access Control</type>
<update_domain>global</update_domain>
<update_guid>a262c37611f1f210984b0a6afda3003f</update_guid>
<update_guid_history>a262c37611f1f210984b0a6afda3003f:-1907255555</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_properties_category_m2m_2c72b7f483527210bdfce7d0deaad37a</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties_category_m2m"><sys_properties_category_m2m action="INSERT_OR_UPDATE"><category display_value="Service and Change Intelligence Sync">b5223fb483527210bdfce7d0deaad3d8</category><order>100</order><property display_value="x_xma_eb_fd.service_and_change_sync_credential_name" name="x_xma_eb_fd.service_and_change_sync_credential_name">2e66b8efc3fdb21072461d0ed4013120</property><sys_class_name>sys_properties_category_m2m</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2026-01-05 14:57:07</sys_created_on><sys_id>2c72b7f483527210bdfce7d0deaad37a</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.service_and_change_sync_credential_name.Service and Change Intelligence Sync</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_properties_category_m2m_2c72b7f483527210bdfce7d0deaad37a</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2026-01-05 14:57:07</sys_updated_on></sys_properties_category_m2m></record_update>]]></payload>
<payload_hash>-1127991147</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>689c188983967210bdfce7d0deaad3b3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b8ea96fe80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>x_xma_eb_fd.service_and_change_sync_credential_name.Service and Change Intelligence Sync</target_name>
<type>Category Property</type>
<update_domain>global</update_domain>
<update_guid>2c72b7f443527210d49cccaa4553ce7e</update_guid>
<update_guid_history>2c72b7f443527210d49cccaa4553ce7e:-1127991147</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_role_2e62c376c3f1f21072461d0ed401314c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl_role"><sys_security_acl_role action="INSERT_OR_UPDATE"><sys_class_name>sys_security_acl_role</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>2e62c376c3f1f21072461d0ed401314c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_security_acl display_value="x_xma_eb_fd_xm_change_map">2e62c376c3f1f21072461d0ed401313c</sys_security_acl><sys_update_name>sys_security_acl_role_2e62c376c3f1f21072461d0ed401314c</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><sys_user_role display_value="x_xma_eb_fd.xmatters_change_map_user" name="x_xma_eb_fd.xmatters_change_map_user">c2624f36c3f1f21072461d0ed40131e1</sys_user_role></sys_security_acl_role></record_update>]]></payload>
<payload_hash>1270228547</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>689c188983967210bdfce7d0deaad3b8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f610000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</target_name>
<type>Access Roles</type>
<update_domain>global</update_domain>
<update_guid>2662c376f0f1f2101c9e2e4bb2876a4f</update_guid>
<update_guid_history>2662c376f0f1f2101c9e2e4bb2876a4f:1270228547</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_script_action_0b1e7af6c3b1f21072461d0ed401318b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;x_xma_eb_fd.change.create&lt;/event_name&gt;&lt;name&gt;x_xma_eb_fd.change.create&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[(function executeAction(current, event) {

    var changeSysId = (event.parm1 || '') + '';
    var changeNum   = (event.parm2 || '') + '';

    gs.info('[changeIntelligenceSync] Script Action fired. changeSysId=' + changeSysId + ' number=' + changeNum);

    if (!changeSysId) {
        gs.error('[changeIntelligenceSync] Missing parm1 (changeSysId).');
        return;
    }

    var sync = new x_xma_eb_fd.changeIntelligenceSync();
    sync.syncChangeBySysId(changeSysId);

})(current, event);
]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 19:45:33&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;0b1e7af6c3b1f21072461d0ed401318b&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;x_xma_eb_fd.change.create&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_0b1e7af6c3b1f21072461d0ed401318b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 19:45:33&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1603855097</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>6c9c188983967210bdfce7d0deaad316</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f100000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd.change.create</table>
<target_name>x_xma_eb_fd.change.create</target_name>
<type>Script Action</type>
<update_domain>global</update_domain>
<update_guid>a04efe3ecc71f210b266efa2de6b8dc7</update_guid>
<update_guid_history>a04efe3ecc71f210b266efa2de6b8dc7:-1603855097</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_u_external_identifier</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="DELETE" element="u_external_identifier" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;external identifier&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;u_external_identifier&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="String"&gt;string&lt;/internal_type&gt;&lt;mandatory&gt;true&lt;/mandatory&gt;&lt;max_length&gt;255&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:05:48&lt;/sys_created_on&gt;&lt;sys_id&gt;8f720b76c3f1f21072461d0ed401318d&lt;/sys_id&gt;&lt;sys_name&gt;u external identifier&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_u_external_identifier&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:05:48&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>1634660982</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>6c9c188983967210bdfce7d0deaad3af</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f800000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.u_external_identifier</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>0c53cbf65bf1f210ce3b8721129781a8</update_guid>
<update_guid_history>0c53cbf65bf1f210ce3b8721129781a8:1634660982,d5e28bb6e0f1f2105e40d5ff8897dbb9:-1925763585</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_42a08556c3f5f21072461d0ed4013177</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_script"&gt;&lt;sys_script action="INSERT_OR_UPDATE"&gt;&lt;abort_action&gt;false&lt;/abort_action&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;action_delete&gt;false&lt;/action_delete&gt;&lt;action_insert&gt;true&lt;/action_insert&gt;&lt;action_query&gt;false&lt;/action_query&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;add_message&gt;false&lt;/add_message&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;change_fields&gt;false&lt;/change_fields&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;collection&gt;cmdb_ci_service&lt;/collection&gt;&lt;condition/&gt;&lt;description/&gt;&lt;execute_function&gt;false&lt;/execute_function&gt;&lt;filter_condition table="cmdb_ci_service"&gt;support_groupISNOTEMPTY^used_for=Production^EQ&lt;item endquery="false" field="support_group" goto="false" newquery="false" operator="ISNOTEMPTY" or="false" value=""/&gt;&lt;item display_value="Production" endquery="false" field="used_for" goto="false" newquery="false" operator="=" or="false" value="Production"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/filter_condition&gt;&lt;is_rest&gt;false&lt;/is_rest&gt;&lt;message/&gt;&lt;name&gt;xM Service Sync  Insert/Update&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;priority&gt;100&lt;/priority&gt;&lt;rest_method/&gt;&lt;rest_method_text/&gt;&lt;rest_service/&gt;&lt;rest_service_text/&gt;&lt;rest_variables/&gt;&lt;role_conditions/&gt;&lt;script&gt;&lt;![CDATA[(function executeRule(current, previous) {

    var op = current.operation();
    if (op !== 'insert' &amp;&amp; op !== 'update') {
        return;
    }

    // Only sync on relevant changes for updates
    if (op === 'update') {
        var relevantChanged =
            (current.isValidField('name')                  &amp;&amp; current.name.changes()) ||
            (current.isValidField('short_description')      &amp;&amp; current.short_description.changes()) ||
            (current.isValidField('business_criticality')   &amp;&amp; current.business_criticality.changes()) ||
            (current.isValidField('busines_criticality')    &amp;&amp; current.busines_criticality.changes()) ||
            (current.isValidField('service_classification') &amp;&amp; current.service_classification.changes()) ||
            (current.isValidField('support_group')          &amp;&amp; current.support_group.changes()) ||
            (current.isValidField('assignment_group')       &amp;&amp; current.assignment_group.changes()) ||
            (current.isValidField('managed_by_group')       &amp;&amp; current.managed_by_group.changes()) ||
            (current.isValidField('used_for')               &amp;&amp; current.used_for.changes()) ||
            (current.isValidField('install_status')         &amp;&amp; current.install_status.changes());

        if (!relevantChanged) {
            return;
        }
    }

    var oldName = '';
    if (op === 'update' &amp;&amp; previous) {
        oldName = previous.getValue('name') || '';
    }

    // parm1 = op, parm2 = old name (for rename-safe sync)
    gs.eventQueue('x_xma_eb_fd.service.sync', current, op, oldName);

})(current, previous);
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-15 21:31:06&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;42a08556c3f5f21072461d0ed4013177&lt;/sys_id&gt;&lt;sys_mod_count&gt;5&lt;/sys_mod_count&gt;&lt;sys_name&gt;xM Service Sync  Insert/Update&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_42a08556c3f5f21072461d0ed4013177&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-19 17:36:08&lt;/sys_updated_on&gt;&lt;template/&gt;&lt;when&gt;after&lt;/when&gt;&lt;/sys_script&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=42a08556c3f5f21072461d0ed4013177"/&gt;&lt;/record_update&gt;</payload>
<payload_hash>1473286205</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>6c9c188983967210bdfce7d0deaad3b4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fd10000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>cmdb_ci_service</table>
<target_name>xM Service Sync  Insert/Update</target_name>
<type>Business Rule</type>
<update_domain>global</update_domain>
<update_guid>c4d33c6b61fdb2105ca38ed741a20c63</update_guid>
<update_guid_history>c4d33c6b61fdb2105ca38ed741a20c63:1473286205,0e88311ec7fdf210ab1704ece1b333a0:-769982090,a03785569839f2109b1373fd4012b6af:699759,6ad6c9164e39f210ab92d26a0dc4f279:2020731597,f65389dac7f5f210770aa79e7df0e664:699759,5f3349dac4f5f210709d4c1ffba6bf10:-1784409508</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_ui_form_sections_bf71cedac331361072461d0ed4013196</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_form_sections form_id="bf71cedac331361072461d0ed4013196" sys_domain="global" table="cmdb_ci_service_group" version="3"><sys_ui_form_section action="INSERT_OR_UPDATE"><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 02:03:08</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>84818a92c371361072461d0ed401319c</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="cmdb_ci_service_group" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">bf71cedac331361072461d0ed4013196</sys_ui_form><sys_ui_section caption="NULL" display_value="" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">0c818a92c371361072461d0ed4013192</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 02:03:08</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 02:03:08</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>08818a92c371361072461d0ed401318e</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="cmdb_ci_service_group" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">bf71cedac331361072461d0ed4013196</sys_ui_form><sys_ui_section caption="General" display_value="General" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">c8818a92c371361072461d0ed4013186</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 02:03:08</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 02:03:08</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>88818a92c371361072461d0ed4013179</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="cmdb_ci_service_group" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">bf71cedac331361072461d0ed4013196</sys_ui_form><sys_ui_section caption="Team" display_value="Team" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">84818a92c371361072461d0ed4013171</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 02:03:08</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 02:03:08</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>08818a92c371361072461d0ed4013192</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="cmdb_ci_service_group" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">bf71cedac331361072461d0ed4013196</sys_ui_form><sys_ui_section caption="Business Need" display_value="Business Need" name="cmdb_ci_service_group" sys_domain="global" view="7325dbf4d0c322105590fd9a5a77e7d1">0c818a92c371361072461d0ed401318e</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 02:03:08</sys_updated_on></sys_ui_form_section><sys_ui_form action="INSERT_OR_UPDATE"><name>cmdb_ci_service_group</name><roles/><sys_class_name>sys_ui_form</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 02:03:07</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>bf71cedac331361072461d0ed4013196</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_ci_service_group</sys_name><sys_overrides/><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_ui_form_sections_bf71cedac331361072461d0ed4013196</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 02:03:07</sys_updated_on><sys_user/><view display_value="Service Portfolio" name="service_portfolio">7325dbf4d0c322105590fd9a5a77e7d1</view><view_name/></sys_ui_form></sys_ui_form_sections></record_update>]]></payload>
<payload_hash>653630539</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>6c9c188983967210bdfce7d0deaad3b9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2ef80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>cmdb_ci_service_group</table>
<target_name>Application Service Group</target_name>
<type>Form Sections</type>
<update_domain>global</update_domain>
<update_guid>0c818a92b2713610ca82162e9e3a979d</update_guid>
<update_guid_history>0c818a92b2713610ca82162e9e3a979d:653630539,8c818a924a7136100428a66715488c6f:-192082119</update_guid_history>
<update_set display_value=""/>
<view>7325dbf4d0c322105590fd9a5a77e7d1</view>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_script_action_40b9719ec3fdf21072461d0ed40131b0</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;x_xma_eb_fd.service.sync&lt;/event_name&gt;&lt;name&gt;x_xma_eb_fd.service.sync&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[(function executeAction(current, event) {

    var op      = event.parm1 + '';   // insert|update
    var oldName = event.parm2 + '';   // previous name if update

    var sync = new x_xma_eb_fd.serviceBatchSync();

    if (!current || !current.isValidRecord()) {
        gs.error('[serviceBatchSync] Script Action: current record not available for event ' + event.name);
        return;
    }

    // Rename-safe path (uses oldName passed from BR)
    if (op === 'update' &amp;&amp; oldName &amp;&amp; oldName !== current.getValue('name')) {
        sync.syncServiceForCiUpdateByOldName(current, oldName);
        return;
    }

    // Normal upsert
    sync.syncServiceForCi(current);

})(current, event);
]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-16 01:29:32&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;40b9719ec3fdf21072461d0ed40131b0&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;x_xma_eb_fd.service.sync&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_40b9719ec3fdf21072461d0ed40131b0&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-16 01:32:43&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1645139974</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a09c188983967210bdfce7d0deaad317</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2ef30000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd.service.sync</table>
<target_name>x_xma_eb_fd.service.sync</target_name>
<type>Script Action</type>
<update_domain>global</update_domain>
<update_guid>e68a39da86fdf21016d575e79957b66e</update_guid>
<update_guid_history>e68a39da86fdf21016d575e79957b66e:-1645139974,77c9f1de03fdf210f384875d42a8b301:-1725979793</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_xm_change_id</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="xm_change_id" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;xm change id&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;xm_change_id&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="String"&gt;string&lt;/internal_type&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;max_length&gt;100&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:12:13&lt;/sys_created_on&gt;&lt;sys_id&gt;2d44c3bac3f1f21072461d0ed40131a9&lt;/sys_id&gt;&lt;sys_name&gt;xm change id&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_xm_change_id&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:12:13&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>1447835171</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a09c188983967210bdfce7d0deaad3b0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f9f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.xm change id</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>1f540bbaaef1f21022cc00fcc721d3f4</update_guid>
<update_guid_history>1f540bbaaef1f21022cc00fcc721d3f4:1447835171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_9ab91ca2c339761072461d0ed4013193</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_script"&gt;&lt;sys_script action="INSERT_OR_UPDATE"&gt;&lt;abort_action&gt;false&lt;/abort_action&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;action_delete&gt;true&lt;/action_delete&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_query&gt;false&lt;/action_query&gt;&lt;action_update&gt;false&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;add_message&gt;false&lt;/add_message&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;change_fields&gt;false&lt;/change_fields&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;collection&gt;cmdb_ci_service&lt;/collection&gt;&lt;condition/&gt;&lt;description/&gt;&lt;execute_function&gt;false&lt;/execute_function&gt;&lt;filter_condition/&gt;&lt;is_rest&gt;false&lt;/is_rest&gt;&lt;message/&gt;&lt;name&gt;xM Service Sync - Delete&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;priority&gt;100&lt;/priority&gt;&lt;rest_method/&gt;&lt;rest_method_text/&gt;&lt;rest_service/&gt;&lt;rest_service_text/&gt;&lt;rest_variables/&gt;&lt;role_conditions/&gt;&lt;script&gt;&lt;![CDATA[(function executeRule(current, previous) {

    var targetName = ((current.getValue('name') || '') + '').trim();
    if (!targetName) return;

    // Use a persistent record for the event context so it can be resolved later.
    var userGr = new GlideRecord('sys_user');
    userGr.get(gs.getUserID());  // must exist

    // parm1 = xMatters service targetName
    // parm2 = deleted CI sys_id (traceability)
    gs.eventQueue('x_xma_eb_fd.service.delete', userGr, targetName, current.getUniqueValue());

})(current, previous);

]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-16 13:09:36&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;9ab91ca2c339761072461d0ed4013193&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name&gt;xM Service Sync - Delete&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_9ab91ca2c339761072461d0ed4013193&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-19 17:22:14&lt;/sys_updated_on&gt;&lt;template/&gt;&lt;when&gt;before&lt;/when&gt;&lt;/sys_script&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=9ab91ca2c339761072461d0ed4013193"/&gt;&lt;/record_update&gt;</payload>
<payload_hash>-366421021</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a09c188983967210bdfce7d0deaad3b5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fca0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>cmdb_ci_service</table>
<target_name>xM Service Sync - Delete</target_name>
<type>Business Rule</type>
<update_domain>global</update_domain>
<update_guid>24a074a347fdb2107fcb2e02540fa19a</update_guid>
<update_guid_history>24a074a347fdb2107fcb2e02540fa19a:-366421021,23512c66ba797610a56ce810539a302b:-2093699808,320ad8e2f839761050548817549d953e:1257005084</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_ui_module_9262c376c3f1f21072461d0ed4013112</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_module"><sys_ui_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="xMatters Change Map">5e62c376c3f1f21072461d0ed401310e</application><filter/><name>xMatters Change Maps</name><order/><path/><path_relative_to_root>false</path_relative_to_root><roles>x_xma_eb_fd.xmatters_change_map_user</roles><sys_class_name>sys_ui_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>9262c376c3f1f21072461d0ed4013112</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Maps</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_ui_module_9262c376c3f1f21072461d0ed4013112</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on><table>x_xma_eb_fd_xm_change_map</table><uncancelable>false</uncancelable><view_name/></sys_ui_module></record_update>]]></payload>
<payload_hash>-1221399519</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a09c188983967210bdfce7d0deaad3ba</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f330000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Maps</target_name>
<type>Module</type>
<update_domain>global</update_domain>
<update_guid>9a62c37686f1f21029d893c0ace69f14</update_guid>
<update_guid_history>9a62c37686f1f21029d893c0ace69f14:-1221399519</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_app_module_56628376c3f1f21072461d0ed40131bf</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_module"><sys_app_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="xMatters Change Map">1a628376c3f1f21072461d0ed40131ba</application><assessment/><device_type/><filter/><hint/><homepage/><image/><link_type>LIST</link_type><map_page/><mobile_title>xMatters Change Maps</mobile_title><mobile_view_name>Mobile</mobile_view_name><name>x_xma_eb_fd_xm_change_map</name><order/><override_menu_roles>false</override_menu_roles><query/><report/><require_confirmation>true</require_confirmation><roles>x_xma_eb_fd.xmatters_change_map_user</roles><sys_class_name>sys_app_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:42</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>56628376c3f1f21072461d0ed40131bf</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Maps</sys_name><sys_overrides/><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_app_module_56628376c3f1f21072461d0ed40131bf</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:42</sys_updated_on><timeline_page/><title>xMatters Change Maps</title><uncancelable>false</uncancelable><view_name/><window_name/></sys_app_module></record_update>]]></payload>
<payload_hash>-522117873</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a49c188983967210bdfce7d0deaad318</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f2a0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Maps</target_name>
<type>Module</type>
<update_domain>global</update_domain>
<update_guid>1e6283766ef1f210aae490998732c5c2</update_guid>
<update_guid_history>1e6283766ef1f210aae490998732c5c2:-522117873</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_external_identifier_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="external_identifier" label="external identifier" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element>external_identifier</element><help/><hint/><label>external identifier</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>external identifiers</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:09:04</sys_created_on><sys_id>78a3473ac3f1f21072461d0ed40131b7</sys_id><sys_mod_count>0</sys_mod_count><sys_name>external identifier</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_external_identifier_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:09:04</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>701319199</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a49c188983967210bdfce7d0deaad3b1</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f850000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.external identifier</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>fca34b3aa0f1f2104a31241f1b3282a2</update_guid>
<update_guid_history>fca34b3aa0f1f2104a31241f1b3282a2:701319199</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_include_334e723ac3b1f21072461d0ed4013163</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;x_xma_eb_fd.changeIntelligenceSync&lt;/api_name&gt;&lt;caller_access/&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description/&gt;&lt;mobile_callable&gt;false&lt;/mobile_callable&gt;&lt;name&gt;changeIntelligenceSync&lt;/name&gt;&lt;sandbox_callable&gt;false&lt;/sandbox_callable&gt;&lt;script&gt;&lt;![CDATA[gs.include('xmApiClient');

var changeIntelligenceSync = Class.create();
changeIntelligenceSync.prototype = {
    initialize: function() {
        this.traceId = gs.generateGUID();
        this.client = new x_xma_eb_fd.xmApiClient({
		credentialsName: gs.getProperty('x_xma_eb_fd.service_and_change_sync_credential_name'),
            traceId: this.traceId
        });

        this.logPrefix       = '[changeIntelligenceSync]';
        this.changeTable     = 'change_request';
        this.instanceBaseUrl = gs.getProperty('glide.servlet.uri');

        // Optional (recommended) idempotency table in your app scope:
        // Create a table: x_xma_eb_fd_xm_change_map
        // Fields (suggested): u_change_sys_id (string, unique), u_change_number, u_xm_change_id, u_sent_at, u_last_error
        this.mapTable = 'x_xma_eb_fd_xm_change_map';
    },

    syncChangeBySysId: function(changeSysId) {
        var chg = new GlideRecord(this.changeTable);
        if (!chg.get(changeSysId)) {
            gs.error(this.logPrefix + ' Change not found: ' + changeSysId);
            return;
        }

        if (this._alreadySent(changeSysId)) {
            gs.info(this.logPrefix + ' Already sent to xMatters; skipping. changeSysId=' + changeSysId);
            return;
        }

        var payload = this.buildXmChangePayloadFromSn(chg);
        if (!payload) {
            gs.info(this.logPrefix + ' No payload produced; skipping. changeSysId=' + changeSysId);
            return;
        }

        var url  = this.client.buildUrl('/changes');
        var resp = this.client.post(url, payload);

        // If service name is invalid in xMatters, a common pattern is failure.
        // Fallback: retry as a GLOBAL change (omit service).
        if (resp &amp;&amp; resp.getStatusCode() &gt;= 400 &amp;&amp; payload.service) {
            gs.info(this.logPrefix + ' POST /changes failed with service="' + payload.service +
                '". Retrying without service (global change). Status=' + resp.getStatusCode());

            var payload2 = this._shallowClone(payload);
            delete payload2.service;

            resp = this.client.post(url, payload2);
        }

        if (!resp) {
            gs.error(this.logPrefix + ' No response from xMatters POST /changes');
            this._markError(changeSysId, chg.getValue('number'), 'No response from POST /changes');
            return;
        }

        var status = resp.getStatusCode();
        var body   = resp.getBody();

        if (status === 201) { // Created 
            var xmId = '';
            try {
                var parsed = JSON.parse(body);
                xmId = parsed.id || '';
            } catch (e) {
                // still treat as success, but log parse issue
                gs.warn(this.logPrefix + ' Created change but could not parse response JSON. ' + e.message);
            }

            gs.info(this.logPrefix + ' Created xMatters change record. changeSysId=' + changeSysId + ' xmId=' + xmId);
            this._markSent(changeSysId, chg.getValue('number'), xmId);
            return;
        }

        gs.error(this.logPrefix + ' Failed POST /changes. Status=' + status + ' Body=' + body);
        this._markError(changeSysId, chg.getValue('number'), 'Status=' + status + ' Body=' + body);
    },

    buildXmChangePayloadFromSn: function(chg) {
        var sysId  = chg.getUniqueValue();
        var number = chg.getValue('number') || '';

        var summary = number;
        var sd = chg.getValue('short_description');
        if (sd) {
            summary = number ? (number + ' - ' + sd) : sd;
        }
        summary = this._truncate(summary, 240);

        var payload = {
            changeType: this._mapChangeType(chg),
            source:     'ServiceNow',
            summary:    summary,
            changedAt:  this._getChangedAtIso(chg),
            changedBy:  this._getChangedBy(chg),
            details:    this._buildDetails(chg),
            externalIdentifier: 'SN:change_request:' + sysId
        };

        var serviceName = this._resolveServiceName(chg);
        if (serviceName) {
            payload.service = serviceName; // name or UUID 
        }

        return payload;
    },

    _resolveServiceName: function(chg) {
        // 1) business_service (preferred for mapping to your synced cmdb_ci_service)
        if (chg.isValidField('business_service') &amp;&amp; !chg.business_service.nil()) {
            return (chg.getDisplayValue('business_service') || '') + '';
        }

        // 2) if cmdb_ci points to a service record, use its display/name
        if (chg.isValidField('cmdb_ci') &amp;&amp; !chg.cmdb_ci.nil()) {
            var ciId = chg.getValue('cmdb_ci');
            var ci = new GlideRecord('cmdb_ci');
            if (ci.get(ciId)) {
                var cls = (ci.getValue('sys_class_name') || '') + '';
                if (cls === 'cmdb_ci_service' || cls.indexOf('cmdb_ci_service') === 0) {
                    return (ci.getValue('name') || ci.getDisplayValue()) + '';
                }
            }
        }

        return '';
    },

    _mapChangeType: function(chg) {
        var type = chg.isValidField('type') ? ((chg.getDisplayValue('type') || '') + '').toLowerCase() : '';
        var cat  = chg.isValidField('category') ? ((chg.getDisplayValue('category') || '') + '').toLowerCase() : '';

        if (cat.indexOf('feature') &gt;= 0) return 'FEATURE_TOGGLE';
        if (type.indexOf('emergency') &gt;= 0) return 'MANUAL';

        if (cat.indexOf('network') &gt;= 0 || cat.indexOf('hardware') &gt;= 0 || cat.indexOf('infrastructure') &gt;= 0) {
            return 'ORCHESTRATION';
        }
        if (cat.indexOf('software') &gt;= 0 || cat.indexOf('application') &gt;= 0) {
            return 'DEPLOY';
        }
        return 'OTHER';
    },

    _getChangedAtIso: function(chg) {
        var candidates = ['work_end', 'end_date', 'closed_at', 'sys_updated_on'];
        for (var i = 0; i &lt; candidates.length; i++) {
            var f = candidates[i];
            if (chg.isValidField(f)) {
                var v = chg.getValue(f);
                if (v) return this._toIsoUtc(v);
            }
        }
        return this._toIsoUtc(new GlideDateTime().getValue());
    },

    _getChangedBy: function(chg) {
        var candidates = ['assigned_to', 'closed_by', 'requested_by', 'opened_by'];
        for (var i = 0; i &lt; candidates.length; i++) {
            var f = candidates[i];
            if (chg.isValidField(f) &amp;&amp; !chg[f].nil()) {
                return (chg.getDisplayValue(f) || '') + '';
            }
        }
        return (chg.getValue('sys_updated_by') || '') + '';
    },

    _buildDetails: function(chg) {
        var url = this._buildSnUrl(chg);

        var detailsObj = {
            source: 'ServiceNow',
            table:  'change_request',
            sys_id: chg.getUniqueValue(),
            number: chg.getValue('number'),
            url:    url,
            state:  chg.getDisplayValue('state'),
            type:   chg.isValidField('type') ? chg.getDisplayValue('type') : '',
            category: chg.isValidField('category') ? chg.getDisplayValue('category') : '',
            priority: chg.isValidField('priority') ? chg.getDisplayValue('priority') : '',
            risk:     chg.isValidField('risk') ? chg.getDisplayValue('risk') : '',
            assignment_group: chg.isValidField('assignment_group') ? chg.getDisplayValue('assignment_group') : '',
            business_service: chg.isValidField('business_service') ? chg.getDisplayValue('business_service') : '',
            cmdb_ci: chg.isValidField('cmdb_ci') ? chg.getDisplayValue('cmdb_ci') : ''
        };

        // Keep it as a JSON string; xMatters accepts raw data in "details". 
        return JSON.stringify(detailsObj);
    },

    _buildSnUrl: function(gr) {
        try {
            var base = this.instanceBaseUrl;
            var link = gr.getLink(); // relative
            if (base &amp;&amp; link) return base + link;
        } catch (e) {}
        return '';
    },

    _toIsoUtc: function(snDateTimeValue) {
        var gdt = new GlideDateTime();
        gdt.setValue(snDateTimeValue); // SN internal UTC
        return gdt.getValue().replace(' ', 'T') + 'Z';
    },

    _truncate: function(s, maxLen) {
        s = (s || '') + '';
        if (s.length &lt;= maxLen) return s;
        return s.substring(0, maxLen - 3) + '...';
    },

    _shallowClone: function(obj) {
        var out = {};
        for (var k in obj) out[k] = obj[k];
        return out;
    },

    _alreadySent: function(changeSysId) {
        var map = new GlideRecord(this.mapTable);
        if (!map.isValid()) {
            // If you haven't created the map table yet, we cannot enforce idempotency here.
            return false;
        }

        map.addQuery('u_change_sys_id', changeSysId);
        map.setLimit(1);
        map.query();
        return map.next();
    },

    _markSent: function(changeSysId, changeNumber, xmChangeId) {
        var map = new GlideRecord(this.mapTable);
        if (!map.isValid()) return;

        map.initialize();
        map.setValue('u_change_sys_id', changeSysId);
        map.setValue('u_change_number', changeNumber);
        map.setValue('u_xm_change_id', xmChangeId);
        map.setValue('u_sent_at', new GlideDateTime().getValue());
        map.insert();
    },

    _markError: function(changeSysId, changeNumber, msg) {
        var map = new GlideRecord(this.mapTable);
        if (!map.isValid()) return;

        // Insert error row (or you can upsert if you prefer)
        map.initialize();
        map.setValue('u_change_sys_id', changeSysId);
        map.setValue('u_change_number', changeNumber);
        map.setValue('u_last_error', this._truncate(msg, 1000));
        map.setValue('u_sent_at', new GlideDateTime().getValue());
        map.insert();
    },

    type: 'changeIntelligenceSync'
};
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 19:46:19&lt;/sys_created_on&gt;&lt;sys_id&gt;334e723ac3b1f21072461d0ed4013163&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;changeIntelligenceSync&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy&gt;read&lt;/sys_policy&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_334e723ac3b1f21072461d0ed4013163&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-19 18:17:58&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<payload_hash>1980595003</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a49c188983967210bdfce7d0deaad3b6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2ff80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>changeIntelligenceSync</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>706d3863e371f210cec7cc5d1dc94e89</update_guid>
<update_guid_history>706d3863e371f210cec7cc5d1dc94e89:1980595003,ff6e363a5db1f210915cd0187bbb2e8a:-1829996455</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_change_sys_id</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="change_sys_id" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;change sys id&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;change_sys_id&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="Reference"&gt;reference&lt;/internal_type&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;max_length&gt;32&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference display_value="" name="change_request"&gt;change_request&lt;/reference&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:10:55&lt;/sys_created_on&gt;&lt;sys_id&gt;9cd38b3ac3f1f21072461d0ed4013193&lt;/sys_id&gt;&lt;sys_name&gt;change sys id&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_change_sys_id&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:10:55&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>-303942677</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a89c188983967210bdfce7d0deaad319</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f890000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.change sys id</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>5814cb7a3af1f2104cfe260da579d1e7</update_guid>
<update_guid_history>5814cb7a3af1f2104cfe260da579d1e7:-303942677</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map__en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="" label="xMatters Change Map" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="INSERT_OR_UPDATE"><element/><help/><hint/><label>xMatters Change Map</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>xMatters Change Maps</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:44</sys_created_on><sys_id>7262c376c3f1f21072461d0ed401315b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>xMatters Change Map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map__en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:44</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>802729925</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a89c188983967210bdfce7d0deaad3b2</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f6d0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>f262c376baf1f210dfe896310e3d907e</update_guid>
<update_guid_history>f262c376baf1f210dfe896310e3d907e:802729925</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_a262c376c3f1f21072461d0ed401312e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl"><sys_security_acl action="INSERT_OR_UPDATE"><active>true</active><admin_overrides>true</admin_overrides><advanced>false</advanced><applies_to/><condition/><controlled_by_refs/><decision_type>allow</decision_type><description>Default access control on x_xma_eb_fd_xm_change_map</description><local_or_existing>Existing</local_or_existing><name>x_xma_eb_fd_xm_change_map</name><operation display_value="read">read</operation><script/><security_attribute/><sys_class_name>sys_security_acl</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>a262c376c3f1f21072461d0ed401312e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_security_acl_a262c376c3f1f21072461d0ed401312e</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><type display_value="record">record</type></sys_security_acl></record_update>]]></payload>
<payload_hash>1913263975</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>a89c188983967210bdfce7d0deaad3b7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f420000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map</target_name>
<type>Access Control</type>
<update_domain>global</update_domain>
<update_guid>2a62c3765ef1f2106fa0177977109530</update_guid>
<update_guid_history>2a62c3765ef1f2106fa0177977109530:1913263975</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_register_261abddec3fdf21072461d0ed40131ff</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><caller_access/><derived_priority>100</derived_priority><description/><event_name>x_xma_eb_fd.service.sync</event_name><fired_by/><priority>100</priority><queue/><suffix>service.sync</suffix><sys_class_name>sysevent_register</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 01:31:50</sys_created_on><sys_id>261abddec3fdf21072461d0ed40131ff</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.service.sync</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sysevent_register_261abddec3fdf21072461d0ed40131ff</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 01:31:50</sys_updated_on><table>cmdb_ci_service</table></sysevent_register></record_update>]]></payload>
<payload_hash>1557890540</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:09</sys_created_on>
<sys_id>ac9c188983967210bdfce7d0deaad314</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2eee0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:09</sys_updated_on>
<table>cmdb_ci_service</table>
<target_name>x_xma_eb_fd.service.sync</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>e95a39126d3136106c410a02c8c2cf0c</update_guid>
<update_guid_history>e95a39126d3136106c410a02c8c2cf0c:1557890540</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_register_573c7eb2c3b1f21072461d0ed401312c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><caller_access/><derived_priority>100</derived_priority><description/><event_name>x_xma_eb_fd.change.create</event_name><fired_by/><priority>100</priority><queue/><suffix>change.create</suffix><sys_class_name>sysevent_register</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 19:38:37</sys_created_on><sys_id>573c7eb2c3b1f21072461d0ed401312c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.change.create</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sysevent_register_573c7eb2c3b1f21072461d0ed401312c</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 19:38:37</sys_updated_on><table>change_request</table></sysevent_register></record_update>]]></payload>
<payload_hash>1022047503</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ac9c188983967210bdfce7d0deaad315</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f0a0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>change_request</table>
<target_name>x_xma_eb_fd.change.create</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>43ac7a7211b1f210a9824d4a5df654a9</update_guid>
<update_guid_history>43ac7a7211b1f210a9824d4a5df654a9:1022047503</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_scope_privilege_080047fec3b1f21072461d0ed401310e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_scope_privilege"><sys_scope_privilege action="INSERT_OR_UPDATE"><operation>read</operation><source_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</source_scope><status>allowed</status><sys_class_name>sys_scope_privilege</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 19:53:10</sys_created_on><sys_id>080047fec3b1f21072461d0ed401310e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>change_request</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_scope_privilege_080047fec3b1f21072461d0ed401310e</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 19:53:10</sys_updated_on><target_name>change_request</target_name><target_scope display_value="Global">global</target_scope><target_type>sys_db_object</target_type></sys_scope_privilege></record_update>]]></payload>
<payload_hash>1638056241</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ac9c188983967210bdfce7d0deaad3b3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f170000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>change_request</target_name>
<type>Cross scope privilege</type>
<update_domain>global</update_domain>
<update_guid>480047fefcb1f210224f9380e759e111</update_guid>
<update_guid_history>480047fefcb1f210224f9380e759e111:1638056241</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_role_a662c376c3f1f21072461d0ed4013128</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl_role"><sys_security_acl_role action="INSERT_OR_UPDATE"><sys_class_name>sys_security_acl_role</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>a662c376c3f1f21072461d0ed4013128</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_security_acl display_value="x_xma_eb_fd_xm_change_map">1662c376c3f1f21072461d0ed4013116</sys_security_acl><sys_update_name>sys_security_acl_role_a662c376c3f1f21072461d0ed4013128</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><sys_user_role display_value="x_xma_eb_fd.xmatters_change_map_user" name="x_xma_eb_fd.xmatters_change_map_user">c2624f36c3f1f21072461d0ed40131e1</sys_user_role></sys_security_acl_role></record_update>]]></payload>
<payload_hash>1633234460</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ac9c188983967210bdfce7d0deaad3b8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f3c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</target_name>
<type>Access Roles</type>
<update_domain>global</update_domain>
<update_guid>aa62c37647f1f210ece7b6085f37dd2c</update_guid>
<update_guid_history>aa62c37647f1f210ece7b6085f37dd2c:1633234460</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_register_737994a2c339761072461d0ed401314b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><caller_access/><derived_priority>100</derived_priority><description/><event_name>x_xma_eb_fd.service.delete</event_name><fired_by/><priority>100</priority><queue/><suffix>service.delete</suffix><sys_class_name>sysevent_register</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-16 13:07:50</sys_created_on><sys_id>737994a2c339761072461d0ed401314b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.service.delete</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sysevent_register_737994a2c339761072461d0ed401314b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-16 13:07:50</sys_updated_on><table>cmdb_ci_service</table></sysevent_register></record_update>]]></payload>
<payload_hash>-555383140</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e09c188983967210bdfce7d0deaad316</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2efe0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>cmdb_ci_service</table>
<target_name>x_xma_eb_fd.service.delete</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>30a9d8a238397610ba0345d1a38a45be</update_guid>
<update_guid_history>30a9d8a238397610ba0345d1a38a45be:-555383140</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_scope_privilege_143854b8c3b9f21072461d0ed40131c0</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_scope_privilege"><sys_scope_privilege action="INSERT_OR_UPDATE"><operation>write</operation><source_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</source_scope><status>allowed</status><sys_class_name>sys_scope_privilege</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-11 02:32:09</sys_created_on><sys_id>143854b8c3b9f21072461d0ed40131c0</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_ci_service</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_scope_privilege_143854b8c3b9f21072461d0ed40131c0</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-11 02:32:09</sys_updated_on><target_name>cmdb_ci_service</target_name><target_scope display_value="Global">global</target_scope><target_type>sys_db_object</target_type></sys_scope_privilege></record_update>]]></payload>
<payload_hash>-1040099734</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e09c188983967210bdfce7d0deaad3b4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2ee90000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>cmdb_ci_service</target_name>
<type>Cross scope privilege</type>
<update_domain>global</update_domain>
<update_guid>dc381c302ef9f210ddcef213db52126b</update_guid>
<update_guid_history>dc381c302ef9f210ddcef213db52126b:-1040099734</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_role_ea62c376c3f1f21072461d0ed4013131</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl_role"><sys_security_acl_role action="INSERT_OR_UPDATE"><sys_class_name>sys_security_acl_role</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>ea62c376c3f1f21072461d0ed4013131</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_security_acl display_value="x_xma_eb_fd_xm_change_map">a262c376c3f1f21072461d0ed401312e</sys_security_acl><sys_update_name>sys_security_acl_role_ea62c376c3f1f21072461d0ed4013131</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><sys_user_role display_value="x_xma_eb_fd.xmatters_change_map_user" name="x_xma_eb_fd.xmatters_change_map_user">c2624f36c3f1f21072461d0ed40131e1</sys_user_role></sys_security_acl_role></record_update>]]></payload>
<payload_hash>1523770562</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e09c188983967210bdfce7d0deaad3b9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f490000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map.x_xma_eb_fd.xmatters_change_map_user</target_name>
<type>Access Roles</type>
<update_domain>global</update_domain>
<update_guid>e262c37695f1f2103b40b4e0553dd434</update_guid>
<update_guid_history>e262c37695f1f2103b40b4e0553dd434:1523770562</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sysevent_script_action_6ba08f32c3f1f21072461d0ed4013140</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;x_xma_eb_fd.change.sync&lt;/event_name&gt;&lt;name&gt;x_xma_eb_fd.change.sync&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[(function executeAction(current, event) {

    var changeSysId = (event.parm1 || '') + '';
    var origin      = (event.parm2 || '') + '';

    gs.info('[changeBatchSync] Script Action fired. sys_id=' + changeSysId + ' origin=' + origin);

    var sync = new x_xma_eb_fd.changeBatchSync();

    // Only trust "current" if it's really a change_request record
    if (current &amp;&amp; current.isValidRecord &amp;&amp; current.isValidRecord() &amp;&amp;
        current.getTableName &amp;&amp; current.getTableName() === 'change_request') {

        // Optional: call core directly (avoids re-query)
        sync.syncChangeForChangeRequest(current, { origin: origin });
        return;
    }

    // Otherwise, force lookup using parm1
    sync.processChangeEvent(null, event);

})(current, event);
]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 19:56:39&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;6ba08f32c3f1f21072461d0ed4013140&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name&gt;x_xma_eb_fd.change.sync&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_6ba08f32c3f1f21072461d0ed4013140&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:29:08&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>647639018</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e49c188983967210bdfce7d0deaad317</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fbd0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd.change.sync</table>
<target_name>x_xma_eb_fd.change.sync</target_name>
<type>Script Action</type>
<update_domain>global</update_domain>
<update_guid>8b38cbbe1df1f210a2c31447732ab72e</update_guid>
<update_guid_history>8b38cbbe1df1f210a2c31447732ab72e:647639018,33c08bbe5bb1f210ddd514dffe8bff49:-141692170,4fc08b32d9f1f210280bf25135abc4fe:-2036448265</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_xm_service_target_name</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="xm_service_target_name" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;xm service target name&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;xm_service_target_name&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="String"&gt;string&lt;/internal_type&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;max_length&gt;500&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:12:52&lt;/sys_created_on&gt;&lt;sys_id&gt;d3648bbac3f1f21072461d0ed4013124&lt;/sys_id&gt;&lt;sys_name&gt;xm service target name&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_xm_service_target_name&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:12:52&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;false&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1417374799</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e49c188983967210bdfce7d0deaad3b0</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fac0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.xm service target name</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>7c8483fa14f1f2106aa86d4902c16f94</update_guid>
<update_guid_history>7c8483fa14f1f2106aa86d4902c16f94:-1417374799</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_b1cdfab6c3b1f21072461d0ed4013199</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_script"&gt;&lt;sys_script action="INSERT_OR_UPDATE"&gt;&lt;abort_action&gt;false&lt;/abort_action&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;action_delete&gt;false&lt;/action_delete&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_query&gt;false&lt;/action_query&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;add_message&gt;false&lt;/add_message&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;change_fields&gt;false&lt;/change_fields&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;collection&gt;change_request&lt;/collection&gt;&lt;condition/&gt;&lt;description/&gt;&lt;execute_function&gt;false&lt;/execute_function&gt;&lt;filter_condition/&gt;&lt;is_rest&gt;false&lt;/is_rest&gt;&lt;message/&gt;&lt;name&gt;xMatters Change Intelligence&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;priority&gt;100&lt;/priority&gt;&lt;rest_method/&gt;&lt;rest_method_text/&gt;&lt;rest_service/&gt;&lt;rest_service_text/&gt;&lt;rest_variables/&gt;&lt;role_conditions/&gt;&lt;script&gt;&lt;![CDATA[(function executeRule(current, previous /*null when async*/) {

    // fire only when closed_at is newly set
    if (current.closed_at.changes() &amp;&amp; !current.closed_at.nil()) {
        gs.eventQueue('x_xma_eb_fd.change.sync', current, current.getUniqueValue(), 'dynamic');
    }

})(current, previous);
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 19:44:40&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;b1cdfab6c3b1f21072461d0ed4013199&lt;/sys_id&gt;&lt;sys_mod_count&gt;6&lt;/sys_mod_count&gt;&lt;sys_name&gt;xMatters Change Intelligence&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_b1cdfab6c3b1f21072461d0ed4013199&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-19 17:36:45&lt;/sys_updated_on&gt;&lt;template/&gt;&lt;when&gt;after&lt;/when&gt;&lt;/sys_script&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=b1cdfab6c3b1f21072461d0ed4013199"/&gt;&lt;/record_update&gt;</payload>
<payload_hash>1850695079</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e49c188983967210bdfce7d0deaad3b5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fd90000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>change_request</table>
<target_name>xMatters Change Intelligence</target_name>
<type>Business Rule</type>
<update_domain>global</update_domain>
<update_guid>85f3b0ab83fdb2103ed2652d4daac9c5</update_guid>
<update_guid_history>85f3b0ab83fdb2103ed2652d4daac9c5:1850695079,1e277b4be5b1b6108356fe5291df01f2:588704353,d422038bfeb97610cb66fff2e89e3b6e:-1684780428,70128f4bb2b9761077f73e08f4f6e8a0:588704353,d531d7fa7e75f2107ffe9a32d4602981:2127735329,02be0736b475f210e94ff2fc5915b016:1607237768,670e7eb6dbb1f21089e886a35521fad3:2127735329</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_user_role_c2624f36c3f1f21072461d0ed40131e1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_user_role"><sys_user_role action="INSERT_OR_UPDATE"><assignable_by/><can_delegate>true</can_delegate><description/><elevated_privilege>false</elevated_privilege><grantable>true</grantable><includes_roles/><name>x_xma_eb_fd.xmatters_change_map_user</name><scoped_admin>false</scoped_admin><suffix>xmatters_change_map_user</suffix><sys_class_name>sys_user_role</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:41</sys_created_on><sys_id>c2624f36c3f1f21072461d0ed40131e1</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd.xmatters_change_map_user</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_user_role_c2624f36c3f1f21072461d0ed40131e1</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:41</sys_updated_on></sys_user_role></record_update>]]></payload>
<payload_hash>-186409862</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e49c188983967210bdfce7d0deaad3ba</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f210000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>x_xma_eb_fd.xmatters_change_map_user</target_name>
<type>Role</type>
<update_domain>global</update_domain>
<update_guid>96624f36dcf1f2106b4d46a9606334e6</update_guid>
<update_guid_history>96624f36dcf1f2106b4d46a9606334e6:-186409862</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_app_module_8d13bb3883527210bdfce7d0deaad356</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_module"><sys_app_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="Everbridge Flow Designer">fc3ad5ccdbed56102b317f93e296193c</application><assessment/><device_type/><filter/><hint/><homepage/><image/><link_type>DIRECT</link_type><map_page/><mobile_title>Service and Change Sync Credentials</mobile_title><mobile_view_name>Mobile</mobile_view_name><name/><order>2200</order><override_menu_roles>false</override_menu_roles><query>system_properties_ui.do?sysparm_title=Service and Change Sync Credentials&amp;sysparm_category=Service and Change Intelligence Sync</query><report/><require_confirmation>true</require_confirmation><roles>x_xma_eb_fd.admin</roles><sys_class_name>sys_app_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2026-01-05 15:02:50</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>8d13bb3883527210bdfce7d0deaad356</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Service and Change Sync Credentials</sys_name><sys_overrides/><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_app_module_8d13bb3883527210bdfce7d0deaad356</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2026-01-05 15:02:50</sys_updated_on><timeline_page/><title>Service and Change Sync Credentials</title><uncancelable>false</uncancelable><view_name/><window_name/></sys_app_module></record_update>]]></payload>
<payload_hash>1564506977</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e89c188983967210bdfce7d0deaad318</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b8eaeab4c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>Service and Change Sync Credentials</target_name>
<type>Module</type>
<update_domain>global</update_domain>
<update_guid>54c3bbb866527210ea5fc6514f1c9c24</update_guid>
<update_guid_history>54c3bbb866527210ea5fc6514f1c9c24:1564506977</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_documentation_x_xma_eb_fd_xm_change_map_u_external_identifier_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation action="DELETE" element="u_external_identifier" label="u external identifier" language="en" table="x_xma_eb_fd_xm_change_map"><sys_documentation action="DELETE"><element>u_external_identifier</element><help/><hint/><label>u external identifier</label><language>en</language><name>x_xma_eb_fd_xm_change_map</name><plural>u external identifiers</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:05:49</sys_created_on><sys_id>19e207b6c3f1f21072461d0ed4013193</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u external identifier</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_documentation_x_xma_eb_fd_xm_change_map_u_external_identifier_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:05:49</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>687228103</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e89c188983967210bdfce7d0deaad3b1</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f7a0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.u_external_identifier</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>8c53cbf693f1f210878a89b5a913289e</update_guid>
<update_guid_history>8c53cbf693f1f210878a89b5a913289e:687228103,d5e28bb6faf1f2106ad5a92a316663bb:-1723354209</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_script_include_91e00772c3f1f21072461d0ed40131f9</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;x_xma_eb_fd.changeBatchSync&lt;/api_name&gt;&lt;caller_access/&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description/&gt;&lt;mobile_callable&gt;false&lt;/mobile_callable&gt;&lt;name&gt;changeBatchSync&lt;/name&gt;&lt;sandbox_callable&gt;false&lt;/sandbox_callable&gt;&lt;script&gt;&lt;![CDATA[gs.include('xmApiClient');

var changeBatchSync = Class.create();
changeBatchSync.prototype = {
    initialize: function() {
        this.traceId = gs.generateGUID();

        this.client = new x_xma_eb_fd.xmApiClient({
          credentialsName: gs.getProperty('x_xma_eb_fd.service_and_change_sync_credential_name'),
            traceId: this.traceId
        });

        this.logPrefix   = '[changeBatchSync]';
        this.changeTable = 'change_request';

        // App-scope table to prevent duplicate xMatters change records
        this.mapTable = 'x_xma_eb_fd_xm_change_map';

        // xMatters changeType options:
        // DEPLOY, FEATURE_TOGGLE, MANUAL, ORCHESTRATION, OTHER, SOURCE_CODE_COMMIT
        this.defaultChangeType = 'OTHER';

        // Shows as "source" in xMatters change records
        this.sourceName = 'ServiceNow';
    },

    // ============================================================
    // BATCH ENTRYPOINT (Scheduled Job calls this)
    // ============================================================

    runBatch: function(options) {
        options = options || {};
        var lookbackDays = options.lookbackDays || 7;
        var maxToQueue   = options.maxToQueue   || 500;
        var dryRun       = options.dryRun === true;

        gs.info(this.logPrefix + ' Starting batch queue. lookbackDays=' + lookbackDays +
            ' maxToQueue=' + maxToQueue + ' dryRun=' + dryRun + ' traceId=' + this.traceId);

        var gr = new GlideRecord(this.changeTable);

        if (gr.isValidField('closed_at')) {
            gr.addNotNullQuery('closed_at');
            gr.addQuery('closed_at', '&gt;=', gs.daysAgoStart(lookbackDays));
            gr.orderByDesc('closed_at');
        } else {
            gr.addQuery('sys_updated_on', '&gt;=', gs.daysAgoStart(lookbackDays));
            gr.orderByDesc('sys_updated_on');
        }

        gr.setLimit(maxToQueue);
        gr.query();

        var scanned = 0;
        var queued  = 0;

        while (gr.next()) {
            scanned++;

            var sysId  = gr.getUniqueValue();
            var number = gr.getValue('number');

            if (dryRun) {
                gs.info(this.logPrefix + ' DRY RUN: would queue change ' + number + ' sys_id=' + sysId);
                continue;
            }

            gs.eventQueue('x_xma_eb_fd.change.sync', gr, sysId, 'batch');
            queued++;
        }

        gs.info(this.logPrefix + ' Batch queue complete. scanned=' + scanned + ' queued=' + queued +
            ' traceId=' + this.traceId);
    },

    // ============================================================
    // EVENT PROCESSING ENTRYPOINT (Script Action calls this)
    // ============================================================

    processChangeEvent: function(current, event) {
        var changeSysId = (event.parm1 || '') + '';

        if (current &amp;&amp; current.isValidRecord &amp;&amp; current.isValidRecord()) {
            return this.syncChangeForChangeRequest(current, { origin: (event.parm2 || '') + '' });
        }

        if (!changeSysId) {
            gs.error(this.logPrefix + ' processChangeEvent: missing parm1 (change sys_id).');
            return;
        }

        var chg = new GlideRecord(this.changeTable);
        if (!chg.get(changeSysId)) {
            gs.error(this.logPrefix + ' processChangeEvent: change not found for sys_id=' + changeSysId);
            return;
        }

        return this.syncChangeForChangeRequest(chg, { origin: (event.parm2 || '') + '' });
    },

    // ============================================================
    // CORE: build payload, enforce idempotency, POST /changes
    // ============================================================

    syncChangeForChangeRequest: function(chgGr, options) {
        options = options || {};

        if (!chgGr) {
            gs.error(this.logPrefix + ' syncChangeForChangeRequest: chgGr is null');
            return;
        }

        if (chgGr.isValidField('closed_at') &amp;&amp; chgGr.closed_at.nil()) {
            gs.info(this.logPrefix + ' Skipping (not closed yet). number=' + chgGr.getValue('number'));
            return;
        }

        var payload = this.buildXmChangesPayloadFromChangeRequest(chgGr);
        if (!payload) {
            gs.info(this.logPrefix + ' Skipping: unable to map change_request to xMatters payload. sys_id=' + chgGr.getUniqueValue());
            return;
        }

        if (this.isAlreadySent(payload.externalIdentifier)) {
            gs.info(this.logPrefix + ' Skipping: already sent externalIdentifier=' + payload.externalIdentifier);
            return;
        }

        var url  = this.client.buildUrl('/changes');
        var resp = this.client.post(url, payload);

        if (!resp) {
            gs.error(this.logPrefix + ' No response from xMatters POST /changes. externalIdentifier=' + payload.externalIdentifier);
            return;
        }

        var status = resp.getStatusCode();
        var body   = resp.getBody();

        if (status === 201 || status === 200) {
            var xmChangeId = '';
            try {
                var parsed = JSON.parse(body || '{}');
                xmChangeId = parsed.id || '';
            } catch (e) {}

            this.markSent(payload.externalIdentifier, chgGr, xmChangeId, payload);

            gs.info(this.logPrefix + ' Created xMatters change record. change=' + chgGr.getValue('number') +
                ' xmChangeId=' + xmChangeId + ' externalIdentifier=' + payload.externalIdentifier);
        } else {
            gs.error(this.logPrefix + ' Failed POST /changes. Status=' + status + ' Body=' + body +
                ' externalIdentifier=' + payload.externalIdentifier);
        }

        return resp;
    },

    // ============================================================
    // MAPPING: change_request -&gt; xMatters /changes payload
    // ============================================================

    buildXmChangesPayloadFromChangeRequest: function(chgGr) {
        var sysId  = chgGr.getUniqueValue();
        var number = chgGr.getValue('number') || '';

        var externalIdentifier = 'SN-CHG:' + sysId;

        var summary = chgGr.getValue('short_description');
        if (!summary) {
            summary = number ? ('Change ' + number) : 'ServiceNow Change';
        } else if (number) {
            summary = number + ' - ' + summary;
        }

        var changedAtIso = this.toIso(
            (chgGr.isValidField('work_end') &amp;&amp; !chgGr.work_end.nil()) ? chgGr.getValue('work_end') :
            ((chgGr.isValidField('closed_at') &amp;&amp; !chgGr.closed_at.nil()) ? chgGr.getValue('closed_at') : chgGr.getValue('sys_updated_on'))
        );

        var changedBy = '';
        if (chgGr.isValidField('closed_by') &amp;&amp; !chgGr.closed_by.nil()) {
            changedBy = chgGr.getDisplayValue('closed_by');
        } else if (chgGr.isValidField('assigned_to') &amp;&amp; !chgGr.assigned_to.nil()) {
            changedBy = chgGr.getDisplayValue('assigned_to');
        } else {
            changedBy = chgGr.getValue('sys_updated_by') || '';
        }

        var changeType  = this.mapChangeType(chgGr);
        var serviceName = this.resolveServiceTargetNameFromChange(chgGr);

        var detailsObj = {
            sys_id: sysId,
            number: number,
            state: chgGr.isValidField('state') ? chgGr.getDisplayValue('state') : '',
        short_description: chgGr.isValidField('short_description') ? (chgGr.getValue('short_description') || '') : '',
            risk:  chgGr.isValidField('risk') ? chgGr.getDisplayValue('risk') : '',
            priority: chgGr.isValidField('priority') ? chgGr.getDisplayValue('priority') : '',
            start_date: chgGr.isValidField('start_date') ? chgGr.getValue('start_date') : '',
            end_date:   chgGr.isValidField('end_date') ? chgGr.getValue('end_date') : '',
            work_start: chgGr.isValidField('work_start') ? chgGr.getValue('work_start') : '',
            work_end:   chgGr.isValidField('work_end') ? chgGr.getValue('work_end') : '',
            url: this.buildRecordUrl(chgGr)
        };

        var payload = {
            changeType: changeType,
            source: this.sourceName,
            summary: summary,
            changedAt: changedAtIso,
            changedBy: changedBy,
            details: JSON.stringify(detailsObj),
            externalIdentifier: externalIdentifier
        };

        if (serviceName) {
            payload.service = serviceName;
        }

        return payload;
    },

    mapChangeType: function(chgGr) {
        var type = (chgGr.isValidField('type') ? (chgGr.getValue('type') || '') : '').toLowerCase();
        var category = (chgGr.isValidField('category') ? (chgGr.getDisplayValue('category') || '') : '').toLowerCase();

        if (category.indexOf('deploy') &gt;= 0 || category.indexOf('release') &gt;= 0 || type === 'standard') {
            return 'DEPLOY';
        }
        if (category.indexOf('feature') &gt;= 0 || category.indexOf('toggle') &gt;= 0) {
            return 'FEATURE_TOGGLE';
        }
        if (category.indexOf('orchestration') &gt;= 0 || category.indexOf('infrastructure') &gt;= 0 || category.indexOf('config') &gt;= 0) {
            return 'ORCHESTRATION';
        }
        if (type === 'emergency') {
            return 'MANUAL';
        }

        return this.defaultChangeType; // OTHER
    },

    resolveServiceTargetNameFromChange: function(chgGr) {
        if (chgGr.isValidField('business_service') &amp;&amp; !chgGr.business_service.nil()) {
            return chgGr.getDisplayValue('business_service');
        }
        return '';
    },

    toIso: function(value) {
        if (!value) {
            return '';
        }
        var gdt = new GlideDateTime(value);
        return (gdt.getValue() + '').replace(' ', 'T') + 'Z';
    },

    buildRecordUrl: function(gr) {
        try {
            var base = gs.getProperty('glide.servlet.uri');
            var link = gr.getLink();
            if (base &amp;&amp; link) {
                return base + link;
            }
        } catch (e) {}
        return '';
    },

    // ============================================================
    // IDEMPOTENCY: prevent duplicates (UPDATED FIELD NAMES)
    // ============================================================

    isAlreadySent: function(externalIdentifier) {
        if (!externalIdentifier) {
            return false;
        }

        var map = new GlideRecord(this.mapTable);
        if (!map.isValid()) {
            gs.error(this.logPrefix + ' Map table not found/invalid: ' + this.mapTable +
                '. Create it to prevent duplicate /changes posts.');
            return false;
        }

        map.addQuery('external_identifier', externalIdentifier);
        map.setLimit(1);
        map.query();
        return map.next();
    },

    markSent: function(externalIdentifier, chgGr, xmChangeId, payload) {
        var map = new GlideRecord(this.mapTable);
        if (!map.isValid()) {
            return;
        }

        // UPSERT (handles races better with unique external_identifier)
        map.addQuery('external_identifier', externalIdentifier);
        map.setLimit(1);
        map.query();

        var isUpdate = map.next();
        if (!isUpdate) {
            map.initialize();
            map.setValue('external_identifier', externalIdentifier);
        }

        map.setValue('change_sys_id', chgGr.getUniqueValue());
        if (chgGr.isValidField('number')) {
            map.setValue('change_number', chgGr.getValue('number'));
        }
        if (xmChangeId) {
            map.setValue('xm_change_id', xmChangeId);
        }
        if (payload &amp;&amp; payload.service) {
            map.setValue('xm_service_target_name', payload.service);
        } else {
            map.setValue('xm_service_target_name', '');
        }

        try {
            if (isUpdate) {
                map.update();
            } else {
                map.insert();
            }
        } catch (e) {
            gs.error(this.logPrefix + ' markSent: failed writing map row for externalIdentifier=' +
                externalIdentifier + ' err=' + e.message);
        }
    },

    type: 'changeBatchSync'
};
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 19:57:19&lt;/sys_created_on&gt;&lt;sys_id&gt;91e00772c3f1f21072461d0ed40131f9&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;changeBatchSync&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy&gt;read&lt;/sys_policy&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_91e00772c3f1f21072461d0ed40131f9&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-19 18:17:17&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<payload_hash>1125278320</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>e89c188983967210bdfce7d0deaad3b6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2ff10000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>changeBatchSync</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>8b3d78231871f2108fe38a702b099344</update_guid>
<update_guid_history>8b3d78231871f2108fe38a702b099344:1125278320,4131fbcbd171b61025fae5e595a73bb2:-979528594,4ca78b724235f21094c3da2943352863:-1553812354,f8f08b723ff1f2108ca2f58996949768:-600780059</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_x_xma_eb_fd_xm_change_map_external_identifier</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update&gt;&lt;sys_dictionary action="INSERT_OR_UPDATE" element="external_identifier" table="x_xma_eb_fd_xm_change_map"&gt;&lt;active&gt;true&lt;/active&gt;&lt;array&gt;false&lt;/array&gt;&lt;attributes/&gt;&lt;audit&gt;false&lt;/audit&gt;&lt;calculation&gt;&lt;![CDATA[(function calculatedFieldValue(current) {

	// Add your code here
	return '';  // return the calculated value

})(current);]]&gt;&lt;/calculation&gt;&lt;choice/&gt;&lt;choice_field/&gt;&lt;choice_table/&gt;&lt;column_label&gt;external identifier&lt;/column_label&gt;&lt;comments/&gt;&lt;create_roles/&gt;&lt;default_value/&gt;&lt;defaultsort/&gt;&lt;delete_roles/&gt;&lt;dependent/&gt;&lt;dependent_on_field/&gt;&lt;display&gt;false&lt;/display&gt;&lt;dynamic_creation&gt;false&lt;/dynamic_creation&gt;&lt;dynamic_creation_script/&gt;&lt;dynamic_default_value/&gt;&lt;dynamic_ref_qual/&gt;&lt;element&gt;external_identifier&lt;/element&gt;&lt;element_reference&gt;false&lt;/element_reference&gt;&lt;foreign_database/&gt;&lt;formula/&gt;&lt;function_definition/&gt;&lt;function_field&gt;false&lt;/function_field&gt;&lt;internal_type display_value="String"&gt;string&lt;/internal_type&gt;&lt;mandatory&gt;true&lt;/mandatory&gt;&lt;max_length&gt;255&lt;/max_length&gt;&lt;name&gt;x_xma_eb_fd_xm_change_map&lt;/name&gt;&lt;next_element/&gt;&lt;primary&gt;false&lt;/primary&gt;&lt;read_only&gt;false&lt;/read_only&gt;&lt;read_roles/&gt;&lt;reference/&gt;&lt;reference_cascade_rule/&gt;&lt;reference_floats&gt;false&lt;/reference_floats&gt;&lt;reference_key/&gt;&lt;reference_qual/&gt;&lt;reference_qual_condition/&gt;&lt;reference_type/&gt;&lt;spell_check&gt;false&lt;/spell_check&gt;&lt;staged&gt;false&lt;/staged&gt;&lt;sys_class_name&gt;sys_dictionary&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-12-17 20:09:04&lt;/sys_created_on&gt;&lt;sys_id&gt;51830ff6c3f1f21072461d0ed401313d&lt;/sys_id&gt;&lt;sys_name&gt;external identifier&lt;/sys_name&gt;&lt;sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Everbridge Flow Designer"&gt;8018d948dbed56102b317f93e2961979&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_dictionary_x_xma_eb_fd_xm_change_map_external_identifier&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-12-17 20:20:16&lt;/sys_updated_on&gt;&lt;table_reference&gt;false&lt;/table_reference&gt;&lt;text_index&gt;false&lt;/text_index&gt;&lt;unique&gt;true&lt;/unique&gt;&lt;use_dependent_field&gt;false&lt;/use_dependent_field&gt;&lt;use_dynamic_default&gt;false&lt;/use_dynamic_default&gt;&lt;use_reference_qualifier&gt;simple&lt;/use_reference_qualifier&gt;&lt;virtual&gt;false&lt;/virtual&gt;&lt;virtual_type&gt;script&lt;/virtual_type&gt;&lt;widget/&gt;&lt;write_roles/&gt;&lt;xml_view&gt;false&lt;/xml_view&gt;&lt;/sys_dictionary&gt;&lt;/record_update&gt;</payload>
<payload_hash>687654948</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ec9c188983967210bdfce7d0deaad319</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2fb80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>xMatters Change Map.external identifier</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>d136c7fe3af1f2108db9830ac740189d</update_guid>
<update_guid_history>d136c7fe3af1f2108db9830ac740189d:687654948,fca34b3abaf1f2105358e0b78909b7a0:911420201</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_properties_2e66b8efc3fdb21072461d0ed4013120</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Enter a configured credential name that will handle syncing services and changes. </description><ignore_cache>true</ignore_cache><is_private>false</is_private><name>x_xma_eb_fd.service_and_change_sync_credential_name</name><read_roles>x_xma_eb_fd.admin</read_roles><suffix>service_and_change_sync_credential_name</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-19 17:55:25</sys_created_on><sys_id>2e66b8efc3fdb21072461d0ed4013120</sys_id><sys_mod_count>2</sys_mod_count><sys_name>x_xma_eb_fd.service_and_change_sync_credential_name</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_properties_2e66b8efc3fdb21072461d0ed4013120</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2026-01-05 15:04:21</sys_updated_on><type>string</type><value>xMattersServiceSync</value><write_roles>x_xma_eb_fd.admin</write_roles></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=2e66b8efc3fdb21072461d0ed4013120"/></record_update>]]></payload>
<payload_hash>-860621826</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ec9c188983967210bdfce7d0deaad3b2</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b8eb00fc00000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table/>
<target_name>x_xma_eb_fd.service_and_change_sync_credential_name</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>6a14bbf8955272107a4b441a2c1b6c87</update_guid>
<update_guid_history>6a14bbf8955272107a4b441a2c1b6c87:-860621826,14683067be31f210da4247236fa561b9:-363004031,b638b8273431f2101c314b9216a730c8:-2095197930</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_e662c376c3f1f21072461d0ed4013135</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl"><sys_security_acl action="INSERT_OR_UPDATE"><active>true</active><admin_overrides>true</admin_overrides><advanced>false</advanced><applies_to/><condition/><controlled_by_refs/><decision_type>allow</decision_type><description>Default access control on x_xma_eb_fd_xm_change_map</description><local_or_existing>Existing</local_or_existing><name>x_xma_eb_fd_xm_change_map</name><operation display_value="write">write</operation><script/><security_attribute/><sys_class_name>sys_security_acl</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2025-12-17 20:03:43</sys_created_on><sys_id>e662c376c3f1f21072461d0ed4013135</sys_id><sys_mod_count>0</sys_mod_count><sys_name>x_xma_eb_fd_xm_change_map</sys_name><sys_package display_value="Everbridge Flow Designer" source="x_xma_eb_fd">8018d948dbed56102b317f93e2961979</sys_package><sys_policy/><sys_scope display_value="Everbridge Flow Designer">8018d948dbed56102b317f93e2961979</sys_scope><sys_update_name>sys_security_acl_e662c376c3f1f21072461d0ed4013135</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2025-12-17 20:03:43</sys_updated_on><type display_value="record">record</type></sys_security_acl></record_update>]]></payload>
<payload_hash>501399019</payload_hash>
<remote_update_set display_value="xMatters Service Center ">649c188983967210bdfce7d0deaad314</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2026-01-05 18:01:10</sys_created_on>
<sys_id>ec9c188983967210bdfce7d0deaad3b7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19b7fae2f500000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2026-01-05 18:01:10</sys_updated_on>
<table>x_xma_eb_fd_xm_change_map</table>
<target_name>x_xma_eb_fd_xm_change_map</target_name>
<type>Access Control</type>
<update_domain>global</update_domain>
<update_guid>6e62c37695f1f210945f2176a6c98237</update_guid>
<update_guid_history>6e62c37695f1f210945f2176a6c98237:501399019</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
